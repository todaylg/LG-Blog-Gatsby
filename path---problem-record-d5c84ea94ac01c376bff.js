webpackJsonp([0x7328be5fac73],{418:function(n,s){n.exports={data:{post:{id:"/Users/lugang/My Github/LG-Blog-Gatsby/content/posts/2019-05-04--problem-record/index.md absPath of file >>> MarkdownRemark",html:'<p>日常工作和学习过程中的一些踩坑记录~</p>\n<h2>踩坑总结：</h2>\n<h3>兼容性：</h3>\n<p><strong>IE</strong></p>\n<ul>\n<li>\n<p>IE8不支持transform、background-color</p>\n</li>\n<li>\n<p>IE9不支持transition、animation、linear-gradient</p>\n</li>\n<li>\n<p>IE不支持animation变化伪类content的动画</p>\n</li>\n</ul>\n<p>hack：</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code class="language-css">\\9     //IE6/IE7/IE8/IE9/IE10都生效 \n\\0     //IE8/IE9/IE10都生效，是IE8/9/10的hack \n\\9\\0   //只对IE9/IE10生效，是IE9/10的hack \n\n<span class="token comment">/* $.browser.msie &amp;&amp; parseInt($.browser.version) === 8 */</span>  \n<span class="token selector">.IE8</span><span class="token punctuation">{</span>   \n   ... <span class="token comment">/* Only works in IE8 */</span>  \n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>条件注释：</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">[</span><span class="token keyword">if</span> <span class="token constant">IE</span><span class="token punctuation">]</span><span class="token operator">></span> 所有的<span class="token constant">IE</span>可识别 <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span>endif<span class="token punctuation">]</span><span class="token operator">--</span><span class="token operator">></span>\n<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">[</span><span class="token keyword">if</span> <span class="token constant">IE</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">></span> 仅<span class="token constant">IE10</span>可识别 <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span>endif<span class="token punctuation">]</span><span class="token operator">--</span><span class="token operator">></span>\n\n<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">[</span><span class="token keyword">if</span> lt <span class="token constant">IE</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token constant">IE10</span>以下版本可识别 <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span>endif<span class="token punctuation">]</span><span class="token operator">--</span><span class="token operator">></span>\n<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">[</span><span class="token keyword">if</span> gte <span class="token constant">IE</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token constant">IE10</span>及以上版本可识别 <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span>endif<span class="token punctuation">]</span><span class="token operator">--</span><span class="token operator">></span></code></pre>\n      </div>\n<p>IE下的背景透明方法：</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code class="language-css"><span class="token selector">.testModal</span><span class="token punctuation">{</span>\n    <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token property">progid</span><span class="token punctuation">:</span>DXImageTransform.Microsoft.<span class="token function">gradient</span><span class="token punctuation">(</span>startColorstr=#7F000000, endColorstr=#7F000000<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0, 0, 0, .6<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p><strong>Chrome低版本（V31）：</strong></p>\n<p>animation及transform需要添加前缀-webkit-，animationEnd事件也是同理(webkitAnimationEnd)。</p>\n<p><strong>搜狗浏览器：</strong></p>\n<p>图片src为空时会出现边框：</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code class="language-css"><span class="token selector">.testArea img[src=""],\n\n.testArea img:not([src])</span> <span class="token punctuation">{</span>\n\n  <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p><strong>H5滚动穿透</strong></p>\n<p>可以先<a href="https://segmentfault.com/a/1190000012313337">参考文章</a></p>\n<p>实测文章中的最终第三个方案中设置<code class="language-text">position: fixed</code>时整个页面会回到顶端，虽然可以记录top值在关闭蒙层时还原top值，但若是蒙层本身带有透明度的话看着背景莫名其妙的变换会很变扭。</p>\n<p>所以最终的完美方案还是引入[iScroll](<a href="https://github.com/cubiq/iscroll">https://github.com/cubiq/iscroll</a>（iScroll使用[CSS实现滚动](<a href="https://iiunknown.gitbooks.io/iscroll-5-api-cn/core.html">https://iiunknown.gitbooks.io/iscroll-5-api-cn/core.html</a>）</p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">//禁用多余滚动</span>\n<span class="token keyword">new</span> <span class="token class-name">iScroll</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$modalEle<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">//再安心处理业务逻辑</span>\n<span class="token punctuation">[</span><span class="token string">\'touchstart\'</span><span class="token punctuation">,</span><span class="token string">\'click\'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">=></span><span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>$modalEle<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>\n    item<span class="token punctuation">,</span>\n    <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">{</span>\n      <span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n     <span class="token punctuation">}</span>\n   <span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n<span class="token comment">//modal的height最好设为100.1vh，+0.1不然少数机型(比如Vivo)底部白边</span></code></pre>\n      </div>\n<p><strong>APP交互坑合集</strong></p>\n<ul>\n<li>\n<p>ios中H5和APP交互采用的是url shema的方式，所以location.href在短时连续多次执行时，会被浏览器默认只执行最后一次（所以发送多个命令的时，需添加间隔，确保多个location.href的操作不被覆盖）</p>\n</li>\n<li>\n<p>微信内分享，只能分享当前URL</p>\n</li>\n<li>\n<p>CSS Filter滤镜在H5很耗性能</p>\n</li>\n</ul>\n<p><strong>CreateJs</strong></p>\n<p>Createjs不支持IOS 8（1.0版本完全无法运行，0.8版本部分功能无法运行）</p>\n<p>issue见 <a href="https://github.com/CreateJS/EaselJS/issues/982">https://github.com/CreateJS/EaselJS/issues/982</a></p>\n<p>官方看起来已经是放弃治疗了，自己翻源码修或者换Pixi吧</p>\n<p><strong>其他</strong></p>\n<p>行高大于等于字体字号时在会因兼容性问题导致字体显示不全（PC比如360极速、H5如小米Max）</p>\n<h3>性能优化</h3>\n<p><strong>节流与防抖</strong></p>\n<div class="gatsby-highlight">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token comment">/**\n * 节流函数（固定周期内，只执行一次动作）\n*/</span>\n<span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> delay<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">let</span> preTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">let</span> now <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span>now <span class="token operator">-</span> preTime<span class="token operator">>=</span> delay<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        preTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token function">throttle</span><span class="token punctuation">(</span>testFunction<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token comment">/**\n\n * 防抖函数（事件触发时，周期内延迟执行，若重复触发，则重设周期，直至周期结束，执行动作）\n\n*/</span>\n\n<span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span>timer<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> delay<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\n  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\n    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n      timer<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\n        <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n<span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token function">debounce</span><span class="token punctuation">(</span>debounceTimer<span class="token punctuation">,</span> testFunction<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>\n      </div>\n<h3>React</h3>\n<p>注意setState与DOM实际更新时机是不同的，二者最好不要有强依赖关系</p>\n<h3>其他</h3>\n<p><strong>特殊字体</strong></p>\n<p>引入特殊字体时可以只提取自己需要的字进行打包，以减小字体文件体积：</p>\n<p><a href="https://github.com/ngdly/sfnttool">ttf字体提取</a></p>\n<p>但是需要注意在Window下，字体字号较小时（一般是小于16px时）会出现部分笔画不清。</p>\n<hr>\n<p><strong>IOS下资源请求必须Https</strong></p>\n<p><strong>WebSocket</strong></p>\n<p>短时高并发（密度至秒级以内）的Socket推送，考虑性能需要丢弃部分同一时刻无法区分先后的消息。</p>\n<p>容错需要多考虑一层跨天清零的情况（比如加票数增加容错只加不减，但是跨天清零时这个逻辑就不能用了）</p>\n<p><strong>jQuery</strong></p>\n<p>jQuery下用Model-Render的写法的话，需要注意render的时候需要同步变化的所有model数据（比如直接操作DOM更改的倒计时这种，可以用闭包变量同步数据）</p>',fields:{slug:"/problem-record/",prefix:"2019-05-04"},frontmatter:{title:"日常采坑记录",author:"todaylg",category:"小结",cover:{childImageSharp:{resize:{src:"/LG-Blog-Gatsby/static/bg-1c53cb7554c3448635e9fad277a51f53-ada8c.jpg"}}}}},authornote:{id:"/Users/lugang/My Github/LG-Blog-Gatsby/content/parts/author.md absPath of file >>> MarkdownRemark",html:"<p><strong>todaylg</strong> </p>"},site:{siteMetadata:{facebook:{appId:""}}}},pathContext:{slug:"/problem-record/",prev:{id:"/Users/lugang/My Github/LG-Blog-Gatsby/content/posts/2019-04-28--video-alpha/index.md absPath of file >>> MarkdownRemark",fields:{slug:"/video-alpha/",prefix:"2019-04-28"},frontmatter:{title:"Web动效通用实现方案探究",category:"小结"}}}}}});
//# sourceMappingURL=path---problem-record-d5c84ea94ac01c376bff.js.map