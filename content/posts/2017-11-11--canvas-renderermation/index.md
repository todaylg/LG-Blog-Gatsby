---
title: åˆæ¢Canvas2Dæ¸²æŸ“ä¸æ•°æ®å¯è§†åŒ–
category: "å°ç»“"
cover: test7.png
author: todaylg




---

ä¸»è¦æ˜¯å¯¹å½“å‰Canvas2Dæ¸²æŸ“æ¡†æ¶è¿›è¡Œäº†äº†è§£å­¦ä¹ ï¼Œå¹¶æœ€ååŸºäºPixi.jsä»¥å¯è§†åŒ–æ¡†æ¶Cytoscapeä¸ºç›®æ ‡åŠ¨æ‰‹è¿›è¡Œäº†ä¸€æ³¢å®è·µï¼š[PGraph](https://github.com/todaylg/PGraph)

## PixiJS

è¯´åˆ°Pixiï¼Œå¦‚æœä½ åœ¨ç©ä¸€äº›H5æ¸¸æˆçš„æ—¶å€™æœ‰çœ‹è¿‡å®ƒçš„æºç çš„è¯é‚£ç›¸ä¿¡ä½ åº”è¯¥å°±ä¸ä¼šé™Œç”Ÿï¼Œå¾ˆå¤šæ¸¸æˆéƒ½æ˜¯åŸºäºPixiå¼€å‘çš„ï¼Œå¤§åé¼é¼çš„H5æ¸¸æˆæ¡†æ¶Phaserä¹Ÿæ˜¯åŸºäºPixiçš„ï¼Œä½†æ˜¯åŸºäºPixiå¯ä¸ä»…ä»…åªèƒ½å¼€å‘æ¸¸æˆï¼ŒåŒ…æ‹¬å¾ˆå¤šç‚«é…·çš„ç½‘ç«™ã€æ•ˆæœã€ç”šè‡³Appéƒ½å¯ä»¥åŸºäºPixiå¼€å‘ï¼ŒPixiå…¶å®æ˜¯ä¸€ä¸ªè¶…å¿«çš„H5 2Dæ¸²æŸ“å¼•æ“ï¼Œæä¾›ä¸€ä¸ªè¶…å¿«å¹¶ä¸”å…¼å®¹æ‰€æœ‰è®¾å¤‡çš„2Dåº“ï¼Œæ ¹æ®è®¾å¤‡å¯¹WebGlã€Canvasçš„æ”¯æŒæƒ…å†µæ™ºèƒ½è¿›è¡Œæ¸²æŸ“å™¨çš„åˆ‡æ¢ï¼Œä»è€Œä¿è¯å…¼å®¹æ€§ä¸é«˜é€Ÿã€‚å¤´å›æ‰“å¼€ **[Pixiå®˜ç½‘](http://www.pixijs.com/)** çš„æˆ‘ç›´æ¥è¢«æ¶²ä½“äº‘çš„æ•ˆæœç»™å“è·ªäº†=>ã€‚ã€‚ã€‚ä¹‹åæ‰‹ä¸€ä¸ªä¸å°å¿ƒåˆç‚¹åˆ°äº†å®ƒçš„ **[ç”»å»Š](http://www.pixijs.com/gallery)** é‡Œï¼Œæœ¬å¹´ä»½çš„è†ç›–ä¹Ÿéƒ½äº¤ä»£åœ¨é‚£äº†ã€‚ã€‚ã€‚

å°è±¡æ¯”è¾ƒæ·±çš„æ˜¯ **[Weareuprising](http://www.weareuprising.com/work)** æˆ‘æ¬¡ã€‚ã€‚è¿™ç¢ç‰‡ç‰¹æ•ˆå’Œå™ªç‚¹ç‰¹æ•ˆï¼Œç®€ç›´äº†ã€‚ã€‚æ„Ÿè§‰è¿˜æ˜¯æŒ‰éŸ³é¢‘é¼“ç‚¹åˆ†æ•£çš„ã€‚ä¸çŸ¥é“æ˜¯ä¸æ˜¯é”™è§‰ã€‚ã€‚ä¸€ç›´æ²¡é—²ä¸‹æ—¶é—´æ¥ç ”ç©¶ï¼Œæœ‰ç©ºä¸€å®šè¦æ‰’ä¸‹æ¥å¥½å¥½ç…ç…(Flag)ï¼ï¼ï¼è§†éŸ³é¢‘ç»“åˆç©çš„é£èµ·çš„=> **[LOL](http://na.leagueoflegends.com/en/featured/champions/trial-of-the-kraken-priestess)**ã€ **[Goplaces](http://goplaces.theheinekencompany.com/en/age-gate)** å±…ç„¶è¿˜å¯ä»¥å°†äº¤äº’å’Œè§†é¢‘è¿™æ ·ç»“åˆã€‚ã€‚ã€‚çœŸçš„æ˜¯ç»™è·ªäº†ã€‚ã€‚

#### Canvas/WebGL/SVG

---

æ—¢ç„¶å’±ä»¬ä»é›¶å¼€å§‹ï¼Œé‚£å¿…ç„¶å¾—å…ˆå¤§æ¦‚äº†è§£è¿™ä¸‰å…„å¼Ÿçš„å…³ç³»ï¼ŒWebå¯è§†åŒ–çš„ä¸»æµæŠ€æœ¯å°±æ˜¯è¿™ä¸‰ï¼Œè€Œè¿™ä¸‰åˆå„è‡ªæœ‰å„è‡ªçš„ç‰¹ç‚¹ã€‚

1.SVG

SVGåŠŸèƒ½å¼ºå¤§å¹¶ä¸”å¾ˆçµæ´»ï¼Œå¹¶ä¸”æœ‰ä¸€äº›æ•ˆæœè¿˜æ˜¯æ— æ³•æ›¿ä»£çš„(æ¯”å¦‚è´èµ›å°”æ›²çº¿ä¸Šç´§è´´æ–‡å­—çš„æ•ˆæœ)ã€‚ä½†æ˜¯æ¯ä¸ªSVGéƒ½æ˜¯ä¸€ä¸ªDOMå…ƒç´ ï¼Œæ•°é‡è¾¾åˆ°ä¸€å®šé™åº¦ä¹‹åä¸å¯é¿å…çš„ä¼šæœ‰æ˜æ˜¾å¡é¡¿ï¼Œå› ä¸ºäº¤äº’ä¼šä½¿å…ƒç´ å‘ç”Ÿæ”¹å˜ï¼ˆä½ç½®ç§»åŠ¨ã€æ ·å¼æ”¹å˜ã€å¢åˆ æ”¹æŸ¥ç­‰ç­‰ï¼‰ä»è€Œè§¦å‘reflowï¼Œreflowä¼šè§¦å‘repaintï¼Œä¸€ä¸ªèŠ‚ç‚¹çš„reflowå¾ˆå¯èƒ½å¯¼è‡´å­èŠ‚ç‚¹ç”šè‡³æ˜¯çˆ¶èŠ‚ç‚¹æˆ–è€…åŒçº§èŠ‚ç‚¹çš„reflowï¼Œæ‰€ä»¥reflowçš„æˆæœ¬å¾ˆé«˜ã€‚SVGåœ¨å¤„ç†åƒçº§çš„æ•°é‡æ—¶å°±å·²ç»æ˜¾å¾—å¾ˆåƒåŠ›äº†ã€‚

2.Canvas

Canvaså°±æ²¡æœ‰reflowçš„æ¦‚å¿µäº†ï¼Œåªæœ‰repaintçš„æ¦‚å¿µï¼Œå› æ­¤åœ¨æ€§èƒ½ä¸Šè¦å¥½è¿‡SVGè®¸å¤šã€‚å› ä¸ºCanvaså®é™…ä¸Šåªæ˜¯ä¸€ä¸ªç”»å¸ƒå…ƒç´ ï¼Œé€šè¿‡getContext()æ–¹æ³•ï¼Œä¼ å…¥å‚æ•°ï¼š'2d',å¯ä»¥è·å¾—2dç»˜å›¾APIæ¥å£å¯¹è±¡ï¼šCanvasRenderingContext2D,æˆ–è€…ä¼ å…¥å‚æ•°'webgl'ï¼Œåˆ™å¯è·å¾—3dç»˜å›¾APIã€‚æœ‰æ—¶å€™åœ¨äº¤æµçš„æ—¶å€™ä¸€ç›´å¿µå¨Canvasã€Canvasçš„ï¼Œä½†æ˜¯æ„æ€å´æ˜¯åœ¨è¯´CanvasRenderingContext2D,äºŒè€…æ˜¯ä¸€ä¸ªçˆ¶å­çº§çš„å…³ç³»ï¼Œåˆ«ææ··å•¦ã€‚CanvasRenderingContext2Dæ˜¯ç”±æµè§ˆå™¨æŒ‰ç…§ **[W3C](https://www.w3.org/TR/2dcontext/#canvasrenderingcontext2d)** è§„å®šçš„ç»Ÿä¸€æ ‡å‡†å®ç°çš„ã€‚

3.WebGL

WebGLåˆ™æ˜¯ä¸€ç§3Dç»˜å›¾æ ‡å‡†ï¼Œå¯ä»¥ç†è§£ä¸ºOpenGLå’ŒJavaScriptæŠ€æœ¯çš„ç»“åˆã€‚å…è®¸å¼€å‘è€…ç›´æ¥å’ŒGPUè¿›è¡Œé€šä¿¡ï¼Œä»è€Œè·å¾—æ¥è‡ªGPUçš„å¼ºå¤§åŠ›é‡ï¼Œæ¸²æŸ“ä»€ä¹ˆå‡ åä¸‡çº§çš„æ•°é‡éƒ½æ˜¯æ´’æ´’æ°´ï¼ˆæ˜¾å¡ç‰›é€¼çš„è¯ï¼‰ï¼Œå¹¶ä¸”ä¹‹åä¸ç®¡ä»€ä¹ˆç²’å­æ•ˆæœã€å›¾å½¢çº¹ç†ä»€ä¹ˆçš„ï¼Œæƒ³ç”»å•¥å°±èƒ½ç”»å•¥ï¼Œç®€ç›´æ˜¯ä¸ºæ‰€æ¬²ä¸ºã€‚ä½†æ˜¯å¯¹åº”çš„è¿™ä¸œè¥¿æœ‰ç‚¹å¤æ‚ï¼Œç”»äº†ä¸ªç‚¹å°±è¦æ¥è¿‘100è¡Œçš„ä»£ç ã€‚ã€‚ã€‚è¿˜éœ€è¦æ‡‚OpenGLã€‚ã€‚æ„Ÿè§‰å‘æœ‰ç‚¹æ·±ã€‚ã€‚ã€‚ç”»äº†ä¸ªç‚¹ä¹‹åå…ˆè·‘è·¯äº†ã€‚ã€‚

#### Pixiæºç æµ…æ

å¾—ç›ŠäºPixiçš„ä»£ç æ¨¡å—åŒ–åˆ†å¾—å¾ˆæ¸…æ¥šï¼Œæ‰€ä»¥è™½ç„¶å…·ä½“çš„ä»£ç å’±çœ‹ä¸æ‡‚ï¼Œä½†æ˜¯æ–‡ä»¶åå­—çœ‹å¾—æ‡‚å•Šï¼Œå‡½æ•°åå­—çœ‹å¾—æ‡‚å•Šå“ˆå“ˆå“ˆï¼Œä¹Ÿèƒ½å¤§æ¦‚çŸ¥é“ä¸ªæ¥é¾™å»è„‰å•¦, é¦–å…ˆä»å…¥å£æ–‡ä»¶index.jså¼€å§‹çª¥æ¢ä¸€ä¸‹ï¼š

```javascript
// import polyfills. Done as an export to make sure polyfills are imported first
export * from './polyfill';

// export core
export * from './core';

// export libs
import deprecation from './deprecation';//æ—§ç‰ˆå­˜åœ¨ï¼Œä½†æ˜¯æ–°ç‰ˆpixiå·²ä¸å†æ”¯æŒçš„ç‰¹æ€§åšå…¼å®¹æ€§æç¤º
import * as accessibility from './accessibility';
import * as extract from './extract';//such like saving an Image
import * as extras from './extras';
import * as filters from './filters';//WebGL-Only
import * as interaction from './interaction';//events
import * as loaders from './loaders';//loading assets, data, and other resources dynamically.
import * as mesh from './mesh';
import * as particles from './particles';
import * as prepare from './prepare';
```

---

è¿™æ ·çœ‹è¿™ä¸ªcoreåº”è¯¥å°±æ˜¯bossäº†ï¼Œæœç„¶ä¸å‡ºæ‰€æ–™ï¼š

```javascript
export * from './const';//æ‰€æœ‰é™æ€å˜é‡
export * from './math';//æ•°å­¦ç›¸å…³è®¡ç®—

import * as utils from './utils';//ä¸€äº›å°çš„å·¥å…·æ–¹æ³•
import * as ticker from './ticker';//æ—¶é’Ÿç±»ï¼Œæ§åˆ¶æ¸²æŸ“å¸§ç‡
import settings from './settings';
import CanvasRenderer from './renderers/canvas/CanvasRenderer';
import WebGLRenderer from './renderers/webgl/WebGLRenderer';

export { settings, utils, ticker, CanvasRenderer, WebGLRenderer };

export { default as glCore } from 'pixi-gl-core';

export { default as Bounds } from './display/Bounds';
export { default as DisplayObject } from './display/DisplayObject';//å¯å±•ç¤ºå¯¹è±¡çš„åŸºç¡€ï¼ŒåŸºç¡€åˆ°ç›´æ¥ç»§æ‰¿è‡ªEventEmitterç±»,ä½†æ˜¯ä»–å´æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä½œä¸ºæ‰€æœ‰å¾…å±•ç¤ºå¯¹è±¡çš„åŸºç±»,ç»§æ‰¿ä¹‹åå¤å†™äº†æ‰æœ‰æ„ä¹‰ã€‚

export { default as Container } from './display/Container';//æœ€å¼ºå¤§çš„åŸºç¡€ç±»
export { default as Transform } from './display/Transform';
export { default as TransformStatic } from './display/TransformStatic';
export { default as TransformBase } from './display/TransformBase';
export { default as Sprite } from './sprites/Sprite';
export { default as CanvasSpriteRenderer } from './sprites/canvas/CanvasSpriteRenderer';
export { default as CanvasTinter } from './sprites/canvas/CanvasTinter';
export { default as SpriteRenderer } from './sprites/webgl/SpriteRenderer';
export { default as Text } from './text/Text';
export { default as TextStyle } from './text/TextStyle';
export { default as TextMetrics } from './text/TextMetrics';
export { default as Graphics } from './graphics/Graphics';//å›¾å½¢
export { default as GraphicsData } from './graphics/GraphicsData';
export { default as GraphicsRenderer } from './graphics/webgl/GraphicsRenderer';
export { default as CanvasGraphicsRenderer } from './graphics/canvas/CanvasGraphicsRenderer';
export { default as Spritesheet } from './textures/Spritesheet';
export { default as Texture } from './textures/Texture';
export { default as BaseTexture } from './textures/BaseTexture';
export { default as RenderTexture } from './textures/RenderTexture';
export { default as BaseRenderTexture } from './textures/BaseRenderTexture';
export { default as VideoBaseTexture } from './textures/VideoBaseTexture';
export { default as TextureUvs } from './textures/TextureUvs';
export { default as CanvasRenderTarget } from './renderers/canvas/utils/CanvasRenderTarget';
export { default as Shader } from './Shader';
export { default as WebGLManager } from './renderers/webgl/managers/WebGLManager';
export { default as ObjectRenderer } from './renderers/webgl/utils/ObjectRenderer';
export { default as RenderTarget } from './renderers/webgl/utils/RenderTarget';
export { default as Quad } from './renderers/webgl/utils/Quad';
export { default as SpriteMaskFilter } from './renderers/webgl/filters/spriteMask/SpriteMaskFilter';
export { default as Filter } from './renderers/webgl/filters/Filter';
export { default as Application } from './Application';
export { autoDetectRenderer } from './autoDetectRenderer';
```

---

é€šè¿‡çœ‹ç»§æ‰¿å…³ç³»å¯ä»¥å¤§æ¦‚äº†è§£åˆ°è¿™ä¸ªDisplayObjectç±»æ˜¯Pixiä¸­æ‰€æœ‰å¯å±•ç¤ºå¯¹è±¡çš„åŸºç¡€äº†ï¼Œæ˜¯ä¸€ä¸ªåŸºç¡€çš„æŠ½è±¡ç±»ï¼ŒContainerç±»ç»§æ‰¿äºDisplayObjectç±»,ä¸»è¦æ·»åŠ äº†ä¸€äº›å¯¹å­å…ƒç´ çš„æ“ä½œæ–¹æ³•ï¼ŒSpriteç±»åˆç»§æ‰¿äºContainerç±»ï¼Œåˆ°è¿™å·²ç»æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹è§çš„å®ä¾‹äº†ï¼Œä¹Ÿå°±æ˜¯å·²ç»å…·è±¡åŒ–äº†çš„ï¼Œæ‰€å®ç°çš„æ–¹æ³•è¿”å›çš„éƒ½å·²ç»æ˜¯è®¡ç®—å¾—å‡ºçš„å…·ä½“æ•°å€¼äº†ï¼ŒGraphç±»ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œç»§æ‰¿Containerç±»ï¼Œè€ŒTextç±»åˆ™ç»§æ‰¿è‡ªSpriteç±»ï¼Œè¿™äº›éƒ½æ˜¯å…·è±¡åŒ–çš„å®ä¾‹äº†ã€‚è€Œç©¿æ’åœ¨å…¶ä¸­çš„Textureæ¯”è¾ƒå¤æ‚ï¼Œååˆ†æ‡µé€¼ã€‚ã€‚æ„Ÿè§‰å¥½åƒç¼ºå›¾å½¢å­¦çš„çŸ¥è¯†äº†ã€‚ã€‚æ‰€ä»¥çŸä¸€çœ¼å¾—äº†å…ˆã€‚ã€‚æœ€åŸå§‹çš„æ˜¯BasicTextureç±»ï¼Œæ ¹æ®ä¸åŒçš„èµ„æºåˆæœ‰VideoBaseTextureè¿™ç§å¤„ç†å…·ä½“ç±»å‹èµ„æºçš„è¾…åŠ©ç±»ï¼Œæœ€åRenderTextureæ ¹æ®WebGLå’ŒCanvasåˆä¼šæœ‰RenderTargetç±»å’ŒCanvasBufferç±»ã€‚ã€‚ã€‚ã€‚ã€‚é¢O__O "â€¦è¿˜æ˜¯ä¸çœ‹äº†ğŸ˜‚

å¯¹äº†ï¼æˆ‘ä»¬ä¸»è¦ç ”ç©¶çš„æ˜¯å›¾å½¢ï¼Œæ‰€ä»¥ç…ç…Graphicsï¼ŒPixiæ¸²æŸ“å›¾å½¢ä¹Ÿæ”¯æŒWebGLç®€ç›´ç¾æ»‹æ»‹ï¼Œæ­£å’Œæˆ‘ä»¬æ„ï¼Œå…·ä½“åˆ°ä»£ç å°±æ˜¯æ•°å­¦å®¶ä¸çŸ©é˜µçš„ç‹‚æ¬¢äº†ã€‚ã€‚å…ˆè·‘è·¯ã€‚

æˆ‘ä»¬å…ˆåœ¨Pixiä¸­ç”»ä¸€äº›åŸºæœ¬çš„å›¾å½¢å¯¹æ¯”ä¸€ä¸‹ç”¨WebGLå’ŒCanvas2dæ¸²æŸ“çš„æƒ…å†µï¼Œæ–¹ä¾¿æˆ‘ä»¬å¯¹è¿™ä¸¤ç§æ–¹å¼æœ‰ä¸ªå¤§æ¦‚çš„ç†è§£ï¼š

å…ˆæ¥WebGLï¼š

<iframe width="100%" height="300" src="//jsfiddle.net/todaylg/mcpg6wos/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

å†çœ‹çœ‹Canvas2Dï¼š

<iframe width="100%" height="300" src="//jsfiddle.net/todaylg/8cea3qw4/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

é¼ æ ‡æ»šè½®å¯ä»¥æ”¾å¤§ç¼©å°ï¼Œå·¦é”®ç‚¹å‡»åå¯ä»¥æ‹–æ‹½ï¼ˆæ¨¡ä»¿Cytoscapeï¼‰ï¼Œæ”¾å¤§ä¹‹åå¯ä»¥æ¯”è¾ƒæ˜æ˜¾çš„çœ‹å‡ºäºŒè€…æ¸²æŸ“ç»“æœçš„å·®åˆ«äº†ï¼ŒWebGLæ¸²æŸ“çš„å›¾å½¢å³ä½¿åŠ äº†æŠ—é”¯é½¿ã€FXAAï¼ˆFast Approximate Anti-Aliasing å¿«é€Ÿè¿‘ä¼¼æŠ—é”¯é½¿ï¼‰ä½†æ˜¯æ•ˆæœè¿˜æ˜¯å’ŒCanvas2Dæœ‰å·®è·ï¼ŒWebGLçš„æŠ—é”¯é½¿æ•ˆæœå¹¶ä¸æ˜¯é‚£ä¹ˆçš„ç†æƒ³ï¼ˆå…·ä½“åŸå› æ²¡ææ˜ç™½ï¼Œå¾…ç ”ç©¶WebGLï¼‰ï¼Œè€ŒCanvas2Dçš„æ•ˆæœåˆ™æ˜¯å¾ˆæ£’äº†ã€‚è™½ç„¶WebGLRenderæ•ˆæœæ²¡æœ‰é‚£ä¹ˆå¥½ï¼Œä½†æ˜¯ä¹Ÿè¿˜èƒ½å‡‘åˆï¼Œç­‰æ•°é‡å¤šäº†ä»¥åWebGLRenderçš„ä¼˜åŠ¿å°±ä¼šå‡¸æ˜¾å‡ºæ¥äº†ã€‚

## Cytoscape

ç›¸æ¯”äºD3çš„å¤§çº¢å¤§ç´«ï¼Œ **[Cytoscape](http://js.cytoscape.org/#introduction/factsheet)** å°±æ˜¾å¾—ä½è°ƒå¾ˆå¤šäº†ï¼ŒCytoscapeæ˜¯ä¸€ä¸ªç”¨äºåˆ†æå’Œå¯è§†åŒ–å›¾å½¢åŠå…³ç³»ç½‘çš„åº“ï¼Œä¸åŒäºD3ï¼ŒCytoscapeåªåŸºäºCanvasè¿›è¡Œäº†
ä¸€ç³»åˆ—çš„å°è£…ï¼Œä½œè€…æ˜¯å¤šä¼¦å¤šå¤§å­¦çš„Donnelly Centreï¼ˆç»™æ•°å­¦å®¶ä»¬çŒ®ä¸Šè†ç›–ã€‚ã€‚ã€‚ï¼‰åŠŸèƒ½ååˆ†å¼ºå¤§ã€‚

## PiCi

é‚£æ—¢ç„¶æœ‰Cytoscapeäº†ï¼Œé‚£è¿˜ç ”ç©¶ä¸ªå•¥ï¼Ÿï¼Ÿæ­£å¦‚ä¹‹å‰æ‰€è¿°ï¼Œå½“æ•°é‡è¾¾åˆ°ä¸‡çº§çš„æ—¶å€™ï¼ŒCanvas2dRenderä¹Ÿå¾—GGäº†ï¼Œè¿™æ—¶å€™WebGLå°±ç§°éœ¸äº†ã€‚æ‰€ä»¥ç°åœ¨ç ”ç©¶çš„å°±æ˜¯èƒ½å¦åŸºäºPixiï¼Œåˆ©ç”¨å®ƒæ”¯æŒWebGLæ¸²æŸ“å¹¶ä¸”å¯ä»¥å‘ä¸‹å…¼å®¹Canvasçš„ç‰¹æ€§ï¼Œåœ¨å¤§æ•°é‡æ¸²æŸ“çš„æ—¶å€™æŠŠæ€§èƒ½æå‡ä¸Šå»å‘¢ï¼Ÿæ¯”å¦‚åœ¨Pixié‡Œé¢å®ç° **[Cytoscapeå®˜ç½‘çš„ä¸€ä¸ªåŸºæœ¬ä¾‹å­](http://js.cytoscape.org/demos/visual-style/)**

<iframe width="100%" height="300" src="//jsfiddle.net/todaylg/f6oj27am/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

è¿™ä¸ªä¾‹å­éº»é›€è™½å°äº”è„ä¿±å…¨ï¼ŒåŒ…å«çš„ä¸œè¥¿æŒºå¤šçš„ï¼Œé¦–å…ˆæ˜¯ **èŠ‚ç‚¹çš„å‡ ä½•ä½“ï¼ˆçŸ©å½¢ã€ä¸‰è§’å½¢ã€åœ†ï¼‰**ã€**èŠ‚ç‚¹ã€è¾¹ä¸Šçš„å­—ã€è¾¹ï¼ˆç›´çº¿å’Œæ›²çº¿ï¼‰**ã€**è¾¹ä¸¤ç«¯çš„ç®­å¤´**ã€**åˆç†çš„å¸ƒå±€**ã€**éšé¼ æ ‡ç„¦ç‚¹çš„æ‹–æ‹½å’Œæ”¾å¤§**ï¼Œä¸”ï¼**æ²¡æœ‰å¤±çœŸ**ï¼é‚£ä¹ˆåŸºäºPixiåˆ°åº•èƒ½å¦å®ç°å‘¢ï¼Ÿå…ˆç»™ç­”æ¡ˆå†è§£é‡Š=>ä¸æ”¹æºç çš„è¯=>ä¸è¡ŒğŸš«ï¼okğŸ‘Œï¼Œå…ˆä¸€ç‚¹ä¸€ç‚¹æ¥å§~ï¼š

### èŠ‚ç‚¹

é¦–å…ˆè‡ªç„¶æ˜¯æœ€åŸºæœ¬çš„èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹æ˜¯å„ç§å¤šè¾¹å½¢ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥å®ç°å‡ºä¸é”™çš„æ•ˆæœï¼š

ç¬¬ä¸€ä¸ªå½“ç„¶æ˜¯ç›´æ¥ç”»ï¼Œåœ†è¿˜å¥½è¯´ï¼ˆå¯ä»¥çœ‹å‰é¢çš„ä¾‹å­ï¼‰ï¼Œåªéœ€è¦ç›®æ ‡ç‚¹çš„åæ ‡ä»¥åŠåœ†åŠå¾„å³å¯ã€‚ä½†æ˜¯è¦æ˜¯å¤šè¾¹å½¢çš„è¯å°±å¾—åƒæ•°å­¦äº†ï¼Œéœ€è¦è‡ªå·±è®¡ç®—å‡ºå„ä¸ªé¡¶ç‚¹çš„åæ ‡ï¼Œå¯¹äºæˆ‘è¿™ç§é«˜æ•° = é«˜ä¸­æ•°å­¦çš„é€‰æ‰‹ï¼Œé‚£è‡ªç„¶æ˜¯ç›¸å½“çš„åƒåŠ›ã€‚

ç¬¬äºŒç§æ–¹æ³•åˆ™æ˜¯å¯åŠ¨Psï¼Œç”»å‡ºéœ€è¦çš„å›¾å½¢ï¼Œå¯¼å‡ºç™½è‰²çš„å›¾å½¢ï¼Œåœ¨Pixiä¸­å°†å›¾ç‰‡è½¬ä¸ºSpriteï¼Œè¿™ä¸‹Pixiå°±å‰å®³äº†ï¼Œå¯ä»¥é€šè¿‡æ›´æ”¹tintæ¥æ›´æ”¹é¢œè‰²ï¼Œè¿™æ ·ä¸€æ¥ä½ ç”»å¾—å‡ºä»€ä¹ˆå›¾ç‰‡ï¼Œå°±èƒ½æ‹¿ä»€ä¹ˆå›¾ç‰‡å½“èŠ‚ç‚¹å•¦ï¼Œä½†æ˜¯è¿™æ ·ä¼šå‡ºç°ä¸¤ä¸ªé—®é¢˜ï¼š1.ç”±äºå›¾ç‰‡åƒç´ çš„é™åˆ¶ä¹Ÿä¸èƒ½ä¿è¯æ— é™æ”¾å¤§ä¸å¤±çœŸäº†ï¼›2.è¿˜éœ€è¦è®¡ç®—ç¢°æ’ä½“ç§¯ï¼Œè¿˜æ˜¯åƒæ•°å­¦ã€‚

å¯¹äºé—®é¢˜ä¸€å’±ä»¬å¯ä»¥åœ¨Pså¯¼å‡ºçš„æ—¶å€™å°±å¯¼å‡ºé«˜åˆ†è¾¨ç‡çš„å›¾ç‰‡ï¼Œè¿™æ ·å°±èƒ½ä¿è¯åœ¨æ”¾å¤§ä¸€å®šç¨‹åº¦ä»¥å†…æ˜¯æ²¡æœ‰å¤±çœŸçš„ï¼Œè¿™åœ¨å®é™…ä½¿ç”¨ä¸­ä¹Ÿæ˜¯å¯ä»¥æ¥å—äº†çš„ï¼Œæ¯•ç«Ÿè°å»ä¸€ç›´æ»šæ»šè½®å•Šï¼ˆå’Œresizeæµè§ˆå™¨çª—å£ä¸€ä¸ªé“ç†ï¼Œåªæœ‰å¼€å‘è€…æ‰ä¼šé—²å¾—æ— èŠè¿™ä¹ˆå¹²ï¼‰ã€‚æ”¾å¤§çš„é—®é¢˜è§£å†³äº†ä½†æ˜¯åˆå‘ç°spriteåœ¨ç¼©å°åè¾¹ç¼˜é”¯é½¿æ•ˆæœéå¸¸ä¸¥é‡ï¼š **[å¥‡æ€ªçš„é—®é¢˜](https://github.com/pixijs/pixi.js/issues/4205)**,åŸå› è¿˜ä¸å¾—è€ŒçŸ¥ã€‚ã€‚ã€‚æ‰€ä»¥è´¯å½»æˆ‘ä»¬æ›²çº¿æ•‘å›½çš„æ–¹é’ˆï¼Œæˆ‘ä»¬ç»™spriteæ·»ä¸Šä¸€ä¸ªBlurFilterï¼Œæ•ˆæœä¸€ä¸‹åˆå¥½äº†ä¸å°‘~

ä½†æ˜¯å¯¹äºé—®é¢˜äºŒã€‚ã€‚ã€‚ã€‚=\> ç›´æ¥æ— è§£ï¼Œç›´æ¥å¿½è§†ï¼Œç›´æ¥ä¸æƒ³ï¼ï¼å’±ä»¬ä»¥åœ†ä¸ºä¾‹å­å³å¯ï¼Œä¸ç„¶è¯é¢˜å°†ä¼šæ²¡æ³•ç»§ç»­äº†ã€‚

è¿™ç§æ–¹æ³•æœ€åå®ç°çš„ä¾‹å­ï¼ˆæ»šè½®æ”¾å¤§ï¼‰ï¼š

<iframe width="100%" height="400" src="//jsfiddle.net/todaylg/z8nwrhj8/7/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

### è¾¹

è¾¹åˆ†ä¸ºç›´çº¿å’Œæ›²çº¿ä¸¤ç§ï¼Œç›´çº¿è‡ªä¸å¿…å¤šè¯´ï¼Œç›´æ¥lineToå³å¯ï¼Œæ›²çº¿å°±å¾—ç”¨è´å¡å°”æ›²çº¿æ¥ç”»äº†ï¼Œæ‰¯åˆ°è¿™ä¸ªè´å¡å°”æ›²çº¿å°±åˆæ¶‰åŠåˆ°æ•°å­¦å®¶ä»¬çš„ç‹‚æ¬¢äº†ã€‚ã€‚ã€‚ä»€ä¹ˆäºŒé˜¶è´å¡å°”ã€ä¸‰é˜¶è´å¡å°”ã€‚ã€‚ã€‚é‚£è¿™ä¸ªè´å¡å°”æ›²çº¿åˆ°åº•æ˜¯å•¥å‘¢ï¼Ÿ

#### è´å¡å°”æ›²çº¿

å…¶å®æ€»è€Œè¨€ä¹‹né˜¶çš„è´å¡å°”æ›²çº¿å°±æœ‰n-1ä¸ªæ§åˆ¶ç‚¹ï¼Œè€Œç”»å‡ºä¸€æ®µè´èµ›å°”æ›²çº¿å°±éœ€è¦èµ·ç‚¹ç»ˆç‚¹ä»¥åŠæ§åˆ¶ç‚¹çš„åæ ‡,è®¡ç®—å…¬å¼å¯è§ **[Wiki](https://en.wikipedia.org/wiki/B%C3%A9zier_curve#Quadratic_curves)**æˆ–è€… **[è¿™é‡Œ](http://blog.csdn.net/zhaopenghhhhhh/article/details/17753615)**,è¦æ˜¯å¯¹æ¨å¯¼è¿‡ç¨‹æœ‰å…´è¶£è¿˜å¯ä»¥çœ‹çœ‹ **[è¿™é‡Œ](http://www.cnblogs.com/equal/p/6414263.html)**(ç»™æ•°å­¦å®¶çŒ®ä¸Šè†ç›–ã€‚ã€‚)ï¼Œç”¨çš„æ—¶å€™ç›´æ¥å¥—å…¬å¼å³å¯ï¼Œæ¯”å¦‚Cytoscapeé‡Œçš„ï¼š

```javascript
//Cytoscape qbezierAt
math.qbezierAt = function( p0, p1, p2, t ){
  return (1 - t) * (1 - t) * p0 + 2 * (1 - t) * t * p1 + t * t * p2;
};
```

---

èµ·ç‚¹å’Œç»ˆç‚¹æˆ‘ä»¬é€šè¿‡æ‰‹åŠ¨èµ‹å€¼æˆ–è€…åé¢è¯´çš„å¸ƒå±€åå°±å¾—åˆ°äº†å…¶åæ ‡ä½ç½®äº†ï¼Œä½†æ˜¯æ§åˆ¶ç‚¹çš„ä½ç½®è¯¥å¦‚ä½•ç§»åŠ¨æ‰èƒ½å®ç°Cytoscapeä¾‹å­ä¸­é‚£æ ·Qå¼¹çš„æ•ˆæœå‘¢ï¼Ÿ

ä»”ç»†è§‚å¯Ÿçš„è¯å¯ä»¥çœ‹å‡ºåº”è¯¥æ˜¯äºŒé˜¶è´å¡å°”æ›²çº¿ï¼Œæ§åˆ¶ç‚¹å–çš„åº”è¯¥æ˜¯èµ·ç»ˆç‚¹çš„ä¸­ç‚¹ï¼Œä½†æ˜¯é«˜åº¦åº”è¯¥éšç€è·ç¦»çš„å‡å°è€Œå¢åŠ ï¼Œæœ‰äº†å¤§è‡´çš„æƒ³æ³•åæˆ‘ä»¬æƒ³æƒ³å¦‚ä½•å…·ä½“å®ç°ã€‚

ç¬¬ä¸€ä¸ªæ–¹æ³•å½“ç„¶æ˜¯ç›´æ¥å»ç¿»Cytoscapeçš„æºç çœ‹å®ƒæ˜¯æ€ä¹ˆç®—çš„å°±è¡Œå•¦~ç¿»åˆ°Cytoscapeæºç extension/renderer/canvas/drawing-edges.jsï¼Œåˆä¼šå‘ç°CRpç»§æ‰¿çš„æ˜¯BRpï¼Œï¼Œå¾€ä¸Šç¿»å›baseä¸‹çš„coord-ele-mathå°±æ˜¯è®¡ç®—çš„å…·ä½“æ–¹æ³•äº†ï¼Œä¸€æ¡è¾¹çš„ç»˜åˆ¶æ€»å…±æ¶‰åŠå››ä¸ªç‚¹çš„åæ ‡ï¼šsourceã€mid-targetã€mid-sourceã€targetï¼Œæ ¹æ®çº¿å½¢çŠ¶çš„ä¸åŒä»¥åŠç®­å¤´å½¢çŠ¶çš„ä¸åŒå„ä¸ªç‚¹è®¡ç®—çš„æ–¹æ³•åˆä¸åŒï¼ˆæ¶‰åŠè§’åº¦ç­‰ç­‰å› ç´ ï¼‰ï¼Œè†ç›–è·ªç©¿äº†éƒ½æ²¡çœ‹æ‡‚å…·ä½“æ˜¯æ€ä¹ˆç®—çš„ã€‚ã€‚ã€‚æä¸æ‡‚è®¡ç®—çš„æ–¹æ³•ä¹Ÿå°±æä¸æ‡‚ä»£ç ä¸­ä¸€äº›æ•°å€¼çš„å«ä¹‰ã€‚ã€‚ä½†æ˜¯ç›´æ¥ä»æºç ä¸­æ‰’å‡ºæ¥ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥ç”¨çš„ã€‚ã€‚ã€‚æ¯”å¦‚æŠŠç”»ä¸‰è§’å½¢ç®­å¤´çš„ä»£ç ç»™æ‰’å‡ºæ¥ï¼š

<iframe width="100%" height="300" src="//jsfiddle.net/todaylg/nwf749rn/3/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

ç¬¬äºŒä¸ªæ–¹æ³•è‡ªç„¶å°±æ˜¯è‡ªå·±æ¥äº†å‘—ã€‚æœ‰äº†å‰é¢è¯´çš„æ€è·¯ï¼Œèµ·ç»ˆç‚¹ä»¥ç®­å¤´çš„å‡ ä½•çŠ¶ä¸åŒå–ä¸åŒçš„ä½ç½®ï¼Œæ¯”å¦‚åœ†å–ä¸­å¿ƒï¼Œä¸‰è§’å½¢å–åº•è¾¹ä¸­å¿ƒè¿™æ ·ï¼Œéš¾ç‚¹åœ¨æ§åˆ¶ç‚¹çš„è®¡ç®—ä¸Šï¼Œåˆ—å‡ºäº†ä¸ªäºŒå…ƒäºŒæ¬¡æ–¹ç¨‹ç»„ç”¨ä¸‡èƒ½å…¬å¼éƒ½æ²¡è§£å‡ºæ¥ï¼ˆèœçš„æŠ è„šã€‚ã€‚ï¼‰ï¼Œæ€»ä¹‹ä¿ç•™è¿™ä¸ªæ€è·¯å˜›å¯ä»¥ï¼Œç­‰å¤§ç¥èµæ•™ä¸€ç•ªæˆ–è€…è¡¥è¡¥é«˜æ•°ä»¥åå†ç»§ç»­ç®—å§ã€‚ã€‚ã€‚

ç¬¬ä¸‰ä¸ªæ–¹æ³•åˆ™æ¯”è¾ƒéº»çƒ¦ï¼šç”±SVGè½¬Canvasæ¥ç›´æ¥ç»˜åˆ¶è´å¡å°”æ›²çº¿ã€‚å…ˆçœ‹d3çš„ä¸€ä¸ªåŸºäºSVGè¾¹æ˜¯è´å¡å°”æ›²çº¿çš„ **[ä¾‹å­](http://bl.ocks.org/mbostock/1153292)**,å®ƒçš„è´å¡å°”æ›²çº¿æ•ˆæœä¸æ­£æ˜¯æˆ‘ä»¬éœ€è¦çš„å—ï¼Ÿçœ‹ä»£ç ï¼š

```javascript
function linkArc(d) {
  var dx = d.target.x - d.source.x,
      dy = d.target.y - d.source.y,
      dr = Math.sqrt(dx * dx + dy * dy);
  return "M" + d.source.x + "," + d.source.y + "A" + dr + "," + dr + " 0 0,1 " + d.target.x + "," + d.target.y;
}
```

---

è¿™é‡Œçš„å®ç°éå¸¸çš„ç®€å•ï¼Œå°±ä¸€å¥ä»£ç ï¼Œé‚£æˆ‘ä»¬åªè¦æŠŠSVGçš„ArcToç”¨Canvasé‡Œçš„arc()æ–¹æ³•æ›¿ä»£ä¸€ä¸‹å°±okå•¦ï¼Œä½†æ˜¯äºŒè€…æ˜¯ä¸åŒçš„ï¼Œå…·ä½“æ€ä¹ˆåœ¨Canvasé‡Œå°†SVG ArcToåšè½¬æ¢æˆ‘æ•´æ˜ç™½ï¼ˆåˆæ˜¯ä¸ªæ•°å­¦é—®é¢˜ã€‚ã€‚ã€‚ï¼‰ä½†æ˜¯æ‰¾æ‰¾githubæœç„¶å·²ç»æœ‰å¤§ä½¬å®ç°äº†ï¼š **[svg-arc-to-cubic-bezier](https://github.com/colinmeinke/svg-arc-to-cubic-bezier)** è¿™ä¸ªåº“ä¸çŸ¥é“ä¸ºå•¥åªæœ‰è¿™ä¹ˆç‚¹starï¼Œä½†æ˜¯å¾ˆå¤šå…¶ä»–åº“éƒ½æ˜¯ä¾èµ–å®ƒçš„ï¼Œæ¯”å¦‚è…¾è®¯çš„ **[pasition](https://github.com/AlloyTeam/pasition)** ã€‚ä½¿ç”¨å®ƒå¯ä»¥å°†ä¸€æ®µSVG Arcè½¬æ¢ä¸ºä¸€æ®µæˆ–è€…å¤šæ®µä¸‰é˜¶è´å¡å°”æ›²çº¿å®ç°ï¼Œè¿”å›è´èµ›å°”æ›²çº¿çš„èµ·ç»ˆç‚¹å’Œä¸¤ä¸ªæ§åˆ¶ç‚¹åæ ‡.è€ŒCanvasä¹Ÿå°è£…äº†ä¸‰é˜¶è´å¡å°”æ›²çº¿æ–¹æ³•bezierCurveToï¼ˆäºŒé˜¶æ˜¯quadraticCurveToï¼‰ï¼Œæ‰€ä»¥æ–¹æ³•ä¸‰å®ç°èµ·æ¥ä¼šæ¯”è¾ƒèˆ’æœï¼ˆä½†æ˜¯ä¸­é—´å¤šäº†ä¸€å±‚è½¬æ¢ï¼Œæ€§èƒ½ä¼šå·®ä¸€ç‚¹ï¼‰ã€‚

#### ç®­å¤´

ç®­å¤´æˆ‘æƒ³åˆ°çš„åŠæ³•æ¯”è¾ƒç¬¨ï¼Œå°±æ˜¯ç®€å•çš„ç›¸ä¼¼ä¸‰è§’å½¢åŠ ä¸Šå››ä¸ªè±¡é™åˆ†åˆ«è®¨è®ºçš„æ–¹æ³•ç¡®å®šåæ ‡ï¼Œæ¯”å¦‚ä¸‰è§’å½¢ï¼š

```javascript

//è¿™ä¸ªä¸‰è§’å½¢é»˜è®¤æŒ‰é¡¶è§’ä¸º50Â°ï¼Œä¸¤ä¸ªåº•è§’ä¸º65Â°æ¥ç®—ï¼Œä¸¤è¾¹é•¿å…ˆæŒ‰ä¸€åŠnodeWidthæ¥ç®—å§
let t_nodeRadius = nodeWidth;
if (!targetFlag && sourcePos.width) t_nodeRadius = sourcePos.width;
if (targetFlag && targetPos.width) t_nodeRadius = targetPos.width;

//è¾¹ç•Œåˆ¤å®š => è´´ä¸€èµ·äº†å°±åˆ«æ˜¾ç¤ºå•¦
if ((Math.abs(source.y - target.y) < t_nodeRadius * 1.5) &&
    (Math.abs(source.x - target.x) < t_nodeRadius * 1.5)) {
    t_nodeRadius = 0;
}

let t_srcPos = targetFlag ? sourcePos : targetPos;
let t_tgtPos = targetFlag ? targetPos : sourcePos;

let topAngle = Math.PI / 180 * 50,//è§’åº¦è½¬å¼§åº¦ï¼Œæ³¨æ„Mathçš„é‚£äº›æ–¹æ³•çš„å•ä½æ˜¯å¼§åº¦
    sideEdge = t_nodeRadius,//ç…ç€åˆé€‚ï¼Œå…ˆå‡‘åˆ
    halfBottomEdge = Math.sin(topAngle / 2) * sideEdge,
    centerEdge = Math.cos(topAngle / 2) * sideEdge;
//angleæ˜¯ä¸€æ ·çš„ï¼Œå…ˆæŒ‰nodeä¸­å¿ƒç®—ï¼Œarrowä¸­å¿ƒç®—ä¹‹åå†è¯´ï¼Œå…ˆtodo(ç›´çº¿ç‰ˆçœ‹å‡ºä¸è¿™ä¸ªé—®é¢˜ï¼Œæ›²çº¿å°±å´©äº†)
let angle = Math.atan(Math.abs(t_srcPos.y - t_tgtPos.y) / Math.abs(t_srcPos.x - t_tgtPos.x));
let beginPosX = t_nodeRadius * Math.cos(angle),
    beginPosY = t_nodeRadius * Math.sin(angle),
    pos1X, pos1Y, pos2X, pos2Y,
    centerX = (t_nodeRadius + centerEdge) * Math.cos(angle),
    centerY = (t_nodeRadius + centerEdge) * Math.sin(angle);

pos1X = pos2X = Math.sin(angle) * halfBottomEdge;
pos1Y = pos2Y = Math.cos(angle) * halfBottomEdge;//ç®€å•çš„å‡ ä½•çŸ¥è¯†(æ‰‹åŠ¨æŠ½æğŸ˜–)

//è¿˜éœ€è¦åˆ†ç±»è®¨è®ºtargetå’Œsourceçš„å·¦å³ä½ç½®çš„å„ç§æƒ…å†µ
//1234ä»£è¡¨targetç›¸å¯¹sourceæ‰€åœ¨è±¡é™
if (t_srcPos.x > t_tgtPos.x) {//sourceèŠ‚ç‚¹åœ¨å³
    if (t_srcPos.y > t_tgtPos.y) {//ä¸‹ ----> 1
        beginPosX = t_tgtPos.x + beginPosX;
        beginPosY = t_tgtPos.y + beginPosY;

        centerX = t_tgtPos.x + centerX;
        centerY = t_tgtPos.y + centerY;

        pos1X = centerX + pos1X;
        pos1Y = centerY - pos1Y;//+ -

        pos2X = centerX - pos2X;
        pos2Y = centerY + pos2Y;//- +
    } else {//ä¸Š ----> 4
        beginPosX = t_tgtPos.x + beginPosX;
        beginPosY = t_tgtPos.y - beginPosY;

        centerX = t_tgtPos.x + centerX;
        centerY = t_tgtPos.y - centerY;

        pos1X = centerX + pos1X;
        pos1Y = centerY + pos1Y;//+ +

        pos2X = centerX - pos2X;
        pos2Y = centerY - pos2Y;//- -
    }

} else {//sourceèŠ‚ç‚¹åœ¨å·¦
    if (t_srcPos.y > t_tgtPos.y) {//ä¸‹ ----> 2
        beginPosX = t_tgtPos.x - beginPosX;
        beginPosY = t_tgtPos.y + beginPosY;

        centerX = t_tgtPos.x - centerX;
        centerY = t_tgtPos.y + centerY;

        pos1X = centerX - pos1X;
        pos1Y = centerY - pos1Y;//- -

        pos2X = centerX + pos2X;
        pos2Y = centerY + pos2Y;//+ +
    } else {//ä¸Š ----> 3
        beginPosX = t_tgtPos.x - beginPosX;
        beginPosY = t_tgtPos.y - beginPosY;

        centerX = t_tgtPos.x - centerX;
        centerY = t_tgtPos.y - centerY;

        pos1X = centerX - pos1X;
        pos1Y = centerY + pos1Y;//- +

        pos2X = centerX + pos2X;
        pos2Y = centerY - pos2Y;//+ -
    }
}

//Draw triangle
let triangle = new Graphics();

triangle.beginFill(0x66CCFF);
triangle.lineStyle(0, 0x66CCFF, 1);
triangle.moveTo(beginPosX, beginPosY);
triangle.lineTo(pos1X, pos1Y);
triangle.lineTo(pos2X, pos2Y);
triangle.endFill();
```

---

æœ€åçš„æ•ˆæœï¼š

<iframe width="100%" height="400" src="//jsfiddle.net/todaylg/z8nwrhj8/3/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

### Zoom/Scale

è¿™ä¸ªå°±æ²¡æœ‰é‚£ä¹ˆå¤šå¥½è¯´çš„äº†ï¼ŒD3ä¹Ÿæœ‰å°è£…å¥½çš„d3-zoom,è‡ªå·±å®ç°çš„è¯éœ€è¦æ³¨æ„çš„å°±æ˜¯stage(canvasä¹Ÿä¸€æ ·)æ”¾å¤§çš„ä¸­å¿ƒæ˜¯å·¦ä¸Šè§’(å³(0,0)),æ‰€ä»¥è¦ä¿è¯æ”¾å¤§ä¹‹åé¼ æ ‡ä½ç½®çš„å›¾å½¢è¿˜ä¿æŒä¸åŠ¨ï¼Œå°±å¾—åˆ†ä¸¤æ­¥èµ°ï¼š1.å…ˆæŠŠå½“å‰é¼ æ ‡åœ¨æµè§ˆå™¨ä¸­çš„ä½ç½®è½¬æ¢ä¸ºåœ¨stageä¸­çš„ä½ç½®ï¼›2.æ ¹æ®æ”¾å¤§è¿˜æ˜¯ç¼©å°ï¼Œstageåšä¸å½“å‰åæ ‡ç›¸åçš„å·®å€¼ä½ç§»ã€‚è¿™æ ·æ”¾å¤§æˆ–è€…ç¼©å°åé¼ æ ‡åœ¨stageä¸­çš„æŒ‡å‘ä½ç½®å°±ä¸ä¼šå˜äº†ã€‚Scaleä¹Ÿæ˜¯ç±»ä¼¼çš„å€’ç«‹ï¼Œåªä¸è¿‡è¦æ³¨æ„stageåšè´Ÿå‘ä½ç§»çš„æ—¶å€™è¦è€ƒè™‘å½“å‰æ”¾å¤§å€æ•°çš„å› ç´ ã€‚

### å¸ƒå±€(Layout)

èŠ‚ç‚¹å°‘çš„æ—¶å€™æˆ‘ä»¬è¿˜å¯ä»¥äººå·¥çš„æ‰‹åŠ¨ç»™èµ‹å€¼ï¼Œæˆ–è€…ç›´æ¥éšæœºèµ‹å€¼ï¼Œä½†æ˜¯å½“æ•°é‡å¤§äº†çš„æ—¶å€™è¿™ä¸¤è€…çš„é—®é¢˜å°±æš´éœ²å¾—å¾ˆæ˜æ˜¾äº†ï¼Œå› ä¸ºèŠ‚ç‚¹å’ŒèŠ‚ç‚¹ä¹‹é—´æ˜¯æœ‰å…³ç³»çš„ï¼Œä¸èƒ½éšæœºä¹±æ”¾ï¼Œæ‰‹åŠ¨èµ‹å€¼åˆ™èµ‹å€¼åˆ°æ‰‹æŠ½ç­‹ã€‚ã€‚ã€‚æ‰€ä»¥å¸ƒå±€è¿˜æ˜¯å¾ˆé‡è¦çš„ï¼Œå¥½çš„å¸ƒå±€èƒ½è®©å…³ç³»å‡¸æ˜¾çš„æ›´åŠ æ¸…æ¥šã€‚

#### Dracula

[Dracula](https://www.graphdracula.net/)å°±æ˜¯ç”¨äºå¸ƒå±€å›¾å½¢å’Œå…³ç³»ç½‘çš„,åªéœ€è¦æ·»åŠ è¾¹ä¿¡æ¯å³å¯èµ‹äºˆèŠ‚ç‚¹ä½ç½®ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š

```javascript
let g = new Dracula.Graph();
for (let i = 0, l = edges.length; i < l; i++) {
    let data = edges[i], id = data.id;
    g.addEdge(data.source, data.target);
}
var layouter = new Dracula.Layout.Spring(g);
layouter.layout();

var renderer = new Dracula.Renderer.Raphael('canvas', g,canvas.width, canvas.height);

renderer.draw();//è¿™é‡Œæ”¹åŠ¨äº†Dragularçš„æºç ,è¿™ä¸ªdrawæ–¹æ³•ä¸å†è¿›è¡Œæ¸²æŸ“

//æ ¹æ®gç”Ÿæˆçš„ä½ç½®è¿›è¡Œåˆå§‹åŒ–
let nodesObj = g.nodes;
for (let node in nodesObj) {...}
```

---

å› ä¸ºæƒ³çœæ—¶é—´çš„åŸå› æ²¡æœ‰å•æŠŠå…¶å¸ƒå±€ç®—æ³•æŠ½å‡ºæ¥ï¼Œè€Œæ˜¯ç²—æš´çš„ç›´æ¥åˆ æ‰æ¸²æŸ“æ–¹æ³•æå‡ºåæ ‡ä¿¡æ¯ã€‚Draculaä½œä¸ºé™æ€å¸ƒå±€æ•ˆæœä¸é”™ï¼Œä½†æ˜¯å¹¶ä¸è€ƒè™‘èŠ‚ç‚¹çš„å¤§å°é—®é¢˜(width)ï¼Œä¼°è®¡å¾—è‡ªå·±åœ¨å…¶ä»£ç åŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥å…ˆä¸æ·±å…¥äº†ã€‚

#### D3-force

åŠ›å¸ƒå±€å°±æ˜¾å¾—æ•ˆæœç‚«é…·å¾ˆå¤šäº†ï¼Œè€Œä¸”å¾—ç›ŠäºD3 V4æ¨¡å—åŒ–åˆ†å¾—å¾ˆæ¸…æ¥šï¼Œå¯ä»¥æŠŠD3-forceå•ç‹¬æ‹å‡ºæ¥ç”¨äºå¸ƒå±€ï¼š

<iframe width="100%" height="400" src="//jsfiddle.net/todaylg/z8nwrhj8/8/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

å…³äºd3-forceçš„å…·ä½“ä»‹ç»å¯ä»¥çœ‹ **[è¿™é‡Œ](https://github.com/xswei/d3js_doc/tree/master/API/d3-force-master#link_distance)** ï¼Œæˆ‘è¯•æ¥è¯•å»ï¼Œä¸€ç§åŠ›ä¸€ç§åŠ›çš„æµ‹è¯•è¿˜æ˜¯æ¯”è¾ƒå¥½ç†è§£çš„ï¼Œä½†æ˜¯ä¸€æ—¦åŠ ä¸Šd3.forceLink(edges)ä¹‹åå°±å˜å¾—å¾ˆå¥‡æ€ªã€‚ã€‚ã€‚è¿™å—è¿˜å¾…ç»§ç»­ç ”ç©¶ã€‚ã€‚

### Text

Textå°±æ˜¯GGçš„åŸå› äº†ã€‚ã€‚è¿˜è®°å¾—æœ€å¼€å§‹åˆæ¢æºç é‚£ä¼šè¯´çš„Textç»§æ‰¿äºSpriteå—ï¼ŸPixiå¯¹æ–‡å­—çš„å¤„ç†ç›¸å½“äºæ˜¯åœ¨Spriteçš„åŸºç¡€ä¸Šçš„ï¼Œç”¨Canvas2dï¼ˆfillText( **[è§„èŒƒ](https://www.w3.org/TR/2dcontext/#dom-context-2d-filltext)** )ï¼‰å¤„ç†æ–‡å­—åæœ€ç»ˆè¿”å›çš„Textå®ä¾‹å³ä½¿è·ŸéšstageåŒæ­¥æ”¾å¤§æ¸²æŸ“å‡ºæ¥çš„æ–‡å­—ä¹Ÿæ˜¯å¤±çœŸçš„ï¼š

<iframe width="100%" height="300" src="//jsfiddle.net/todaylg/z8nwrhj8/9/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

Textå®ä¾‹å³ä½¿è·ŸéšstageåŒæ­¥ç¼©æ”¾ï¼š

<iframe width="100%" height="300" src="//jsfiddle.net/todaylg/z8nwrhj8/11/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

WebGLæ€ä¹ˆæ¸²æŸ“å‡ºæ”¾å¤§åä¸å¤±çœŸçš„å­—ä½“ï¼ŸCanvas2dåˆæ˜¯æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜çš„å‘¢ï¼Ÿæƒ³å¼„æ˜ç™½ä¼°è®¡å¾—è¡¥è¡¥å›¾å½¢å­¦ï¼ˆWebGL3Dï¼‰å¹¶ä¸”å»çœ‹æµè§ˆå™¨å†…æ ¸ï¼ˆCanvas2Dï¼‰æ˜¯æ€ä¹ˆå®ç°çš„äº†ï¼Œç–¯ç‹‚çš„è§¦åŠç€æˆ‘çš„çŸ¥è¯†ç›²åŒºã€‚ã€‚ã€‚å¸Œæœ›ä»¥åèƒ½ææ˜ç™½å§ã€‚ã€‚ã€‚ã€‚

## CreateJS

å’ŒPixiä¸€æ ·ï¼ŒCreateJSä¹Ÿæ˜¯ä¸€ä¸ªH5 2Dæ¸²æŸ“å¼•æ“ï¼Œåœ¨ä»Šå¹´9.16å·æ›´æ–°çš„1.0ç‰ˆæœ¬ï¼Œä½†æ˜¯è¦çŸ¥é“ä¸Šä¸€ä¸ªç‰ˆæœ¬0.8.2æ˜¯åœ¨2015å¹´æ›´æ–°çš„ã€‚ã€‚ã€‚æ—¶éš”2å¹´çªç„¶æ›´æ–°äº†ä¸€ä¸‹ï¼Œè¿™ä¸¤å¹´ä»–ä»¬åˆ°åº•ç»å†äº†ä»€ä¹ˆï¼Ÿè¿å®˜ç½‘éƒ½åœç•™åœ¨ä¸¤å¹´å‰ã€‚ã€‚å„ç§è«åå…¶å¦™ä¸ç”±çš„è®©äººæƒ³è¯•è¯•è¿™ä¸ªæ¡†æ¶2333ã€‚æ‰€ä»¥å¹²è„†æ¥ç€ä¸Šè¾¹è¢«å¡ä½å¯¹æ–‡å­—æ¸²æŸ“é—®é¢˜ç»§ç»­æ‹¿CreateJSå¾€ä¸‹æŠ˜è…¾å§~

CreateJSä¹Ÿæä¾›WebGLä¸Canvas2Dä¸¤ä¸ªRenderer,é»˜è®¤æ˜¯ä½¿ç”¨Canvas2D,å¦‚æœè®¾ç½®ä¸ºWebGLæ¸²æŸ“ï¼Œå½“é‡åˆ°WebGLä¸æ”¯æŒæ¸²æŸ“çš„Shapeã€Shadowã€Textçš„æ—¶å€™ä¼šç›´æ¥å¿½è§†æ‰ï¼ˆä¸è¿›è¡Œæ¸²æŸ“ï¼‰ã€‚

### Text

CreateJSæ¸²æŸ“Textä½¿ç”¨çš„æ˜¯Canvas2D,æ‰€ä»¥è‡ªç„¶æ˜¯æ— å¤±çœŸçš„ï¼Œå¯¹äºèŠ‚ç‚¹æ¥è¯´Texté»˜è®¤åº”å½“å¤„äºèŠ‚ç‚¹çš„æ­£ä¸­é—´ï¼Œå¯¹äºç›´è¾¹æ¥è¯´ä¹Ÿæ˜¯è¿™æ ·ï¼Œä½†æ˜¯å¯¹äºè´èµ›å°”æ›²çº¿çš„è¾¹è¿™é‡Œè¿˜æ²¡æœ‰æƒ³åˆ°å¾ˆå¥½çš„å®ç°æ–¹æ³•ï¼Œæ‰€ä»¥å…ˆæ”¾åœ¨è´èµ›å°”æ›²çº¿ä¸¤ä¸ªæ§åˆ¶ç‚¹çš„ä¸­ç‚¹:

<iframe width="100%" height="400" src="//jsfiddle.net/todaylg/03Ladyqs/10/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

### Pin Effect

å›¾é’‰æ•ˆæœå¯ä»¥ç›´æ¥é€šè¿‡è®¾ç½®D3-forceçš„fxã€fyæ¥å®ç°ï¼Œæ‹–æ‹‰ä»¥ååŒå‡»å¯ä»¥æ¢å¤å¼¹åŠ›ï¼š

<iframe width="100%" height="400" src="//jsfiddle.net/todaylg/03Ladyqs/11/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

### Right Click/Add Image

å³é”®èœå•å°±æ²¡å•¥å¥½è¯´çš„äº†ï¼Œæ·»åŠ å›¾ç‰‡è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹è½¬æˆBitmapåç”±äºBitmapæ ¼å¼å·²ç»è¶³å¤Ÿç®€å•æ‰€ä»¥ä¸ç”¨cacheåè€Œä¼šå¥½ä¸€äº›ï¼ˆä½†æ˜¯å¦‚æœç”¨äº†filteråˆ™å¿…é¡»ä½¿ç”¨cacheï¼‰ï¼š

<iframe width="100%" height="400" src="//jsfiddle.net/todaylg/03Ladyqs/12/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

## Two.js

[two.js](https://two.js.org/)å’ŒCreateJSä¸€æ ·ï¼Œç»™äººçš„æ„Ÿè§‰éƒ½æ˜¯æ‡’ç™Œæ‚£è€…ï¼Œtwo.jsæœ€è¿‘çš„ç‰ˆæœ¬æ›´æ–°çš„æ—¶é—´æ˜¯åœ¨2016å¹´2æœˆã€‚ã€‚ã€‚

ä½†æ˜¯æ”¯æŒWebGLæ¸²æŸ“å­—ä½“ä¸”æ•ˆæœç†æƒ³çš„æˆ‘åªæ‰¾åˆ°äº†å®ƒã€‚ã€‚

<iframe width="100%" height="300" src="//jsfiddle.net/todaylg/b7fLwvcd/1/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

ä½†æ˜¯è¿™å…„å¼Ÿé•¿æ—¶é—´ä¸æ›´æ–°åƒæ˜¯æ”¾å¼ƒæ²»ç–—äº†æ˜¯ä¸€å›äº‹ï¼Œå¦ä¸€å›äº‹æ˜¯è¿™å…„å¼Ÿåœ¨æ€§èƒ½è¡¨ç°ä¸Šä¸å¤ªç†æƒ³ã€‚ã€‚ã€‚æˆ–è€…è¯´ååˆ†ä¸ç†æƒ³ï¼ŒåŸå› è¿˜æ²¡æœ‰æ·±ç©¶ï¼š

\[æµ‹è¯•åœ¨è¿™é‡Œ\]([https://two.js.org/examples/particle-sandbox.html?type=webgl&shapes=circle&operations=translation&count=2000](https://two.js.org/examples/particle-sandbox.html?type=webgl&shapes=circle&operations=translation&count=2000)
)

2000ä¸ªè¿åŠ¨çš„åœ†åœ¨WebGLä¸‹ä¹ŸGGäº†ã€‚ã€‚ã€‚ã€‚è¦çŸ¥é“D3ç»™1000å¤šä¸ªèŠ‚ç‚¹ä½¿ç”¨d3-forceä¸”æ˜¯ä½¿ç”¨ç”¨SVGçš„éƒ½èƒ½ååˆ†æµç•…ã€‚ã€‚ã€‚ã€‚

## ç»“è®º

è‡ªå·±ç¼ºä¸œè¥¿ï¼Œé—®é¢˜ç ”ç©¶åˆ°åº•ä¸‹ä¼šå‘ç°å¼€å§‹å¯¸æ­¥éš¾è¡Œï¼Œä¸€æ–¹é¢ç¼ºåˆ°æ˜¯ç®—æ³•å’Œæ•°å­¦ï¼Œç‰¹åˆ«æ˜¯ä¸å¯è§†åŒ–æ–¹é¢ç›¸å…³çš„ä¸è¿™ä¸¤çš„å…³ç³»å°±æ›´ä¸ºå¯†åˆ‡äº†ï¼Œç‚«é…·çš„æ•ˆæœåé¢éƒ½æ˜¯æ•°å­¦ï¼›å¦ä¸€æ–¹é¢æ˜¯ç¼ºå›¾å½¢å­¦è¿™äº›ä¸€å¤§å—ä¸€å¤§å—çš„è®¡ç®—æœºçŸ¥è¯†ä½“ç³»ï¼Œæ‰€ä»¥ç ”ç©¶ä¸å¾—ä¸åªåœç•™åœ¨åˆæ¢ã€‚ã€‚ã€‚å¸Œæœ›å®‰å¿ƒæ‹¿äº†é€šä¿¡æ¯•ä¸šè¯ä»¥åæ—©ç‚¹æŠŠè®¡ç§‘çš„çŸ¥è¯†è¡¥ä¸Šå§ã€‚ã€‚ã€‚å†ç»§ç»­ç ”ç©¶å§ã€‚ã€‚ã€‚

## To Be Continued
