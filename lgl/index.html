<!DOCTYPE html><html lang="zh" prefix="og: http://ogp.me/ns#"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/LG-Blog-Gatsby/app.114d644fbd0f178a7b99.css">@font-face{font-display:swap;font-family:Open Sans;font-style:normal;font-weight:300;src:local("Open Sans Light "),local("Open Sans-Light"),url(/LG-Blog-Gatsby/static/open-sans-latin-300-60c866748ff15f5b347fdba64596b1b1.woff2) format("woff2"),url(/LG-Blog-Gatsby/static/open-sans-latin-300-521d17bc9f3526c690e8ada6eee55bec.woff) format("woff")}@font-face{font-display:swap;font-family:Open Sans;font-style:italic;font-weight:300;src:local("Open Sans Light italic"),local("Open Sans-Lightitalic"),url(/LG-Blog-Gatsby/static/open-sans-latin-300italic-06bbd3188b34820cd83a0e0b3d0a6f57.woff2) format("woff2"),url(/LG-Blog-Gatsby/static/open-sans-latin-300italic-8a648ff38ded89ea15916e84529d62d3.woff) format("woff")}@font-face{font-display:swap;font-family:Open Sans;font-style:normal;font-weight:400;src:local("Open Sans Regular "),local("Open Sans-Regular"),url(/LG-Blog-Gatsby/static/open-sans-latin-400-cffb686d7d2f4682df8342bd4d276e09.woff2) format("woff2"),url(/LG-Blog-Gatsby/static/open-sans-latin-400-bf2d0783515b7d75c35bde69e01b3135.woff) format("woff")}@font-face{font-display:swap;font-family:Open Sans;font-style:italic;font-weight:400;src:local("Open Sans Regular italic"),local("Open Sans-Regularitalic"),url(/LG-Blog-Gatsby/static/open-sans-latin-400italic-987032ea5d57c93d8da215678eae3b86.woff2) format("woff2"),url(/LG-Blog-Gatsby/static/open-sans-latin-400italic-db70d0b9cb27ada1a260a2b35e756b8b.woff) format("woff")}@font-face{font-display:swap;font-family:Open Sans;font-style:normal;font-weight:600;src:local("Open Sans SemiBold "),local("Open Sans-SemiBold"),url(/LG-Blog-Gatsby/static/open-sans-latin-600-223a277bd88d8a90c8cdf24cda0ad5f5.woff2) format("woff2"),url(/LG-Blog-Gatsby/static/open-sans-latin-600-1cd5320f8937d337b61d5117cf9d7b28.woff) format("woff")}@font-face{font-display:swap;font-family:Open Sans;font-style:italic;font-weight:600;src:local("Open Sans SemiBold italic"),local("Open Sans-SemiBolditalic"),url(/LG-Blog-Gatsby/static/open-sans-latin-600italic-4950a7205f0b5cefe41fc03ac346e236.woff2) format("woff2"),url(/LG-Blog-Gatsby/static/open-sans-latin-600italic-318ea1ada4102c0704a0637228dcad03.woff) format("woff")}@font-face{font-display:swap;font-family:Open Sans;font-style:normal;font-weight:700;src:local("Open Sans Bold "),local("Open Sans-Bold"),url(/LG-Blog-Gatsby/static/open-sans-latin-700-d08c09f2f169f4a6edbcf8b8d1636cb4.woff2) format("woff2"),url(/LG-Blog-Gatsby/static/open-sans-latin-700-623e3205570002af47fc2b88f9335d19.woff) format("woff")}@font-face{font-display:swap;font-family:Open Sans;font-style:italic;font-weight:700;src:local("Open Sans Bold italic"),local("Open Sans-Bolditalic"),url(/LG-Blog-Gatsby/static/open-sans-latin-700italic-c02f5da6e82e1efe0b45841bfd49ce37.woff2) format("woff2"),url(/LG-Blog-Gatsby/static/open-sans-latin-700italic-72e19cbb0e38c6773a7751156752cec4.woff) format("woff")}@font-face{font-display:swap;font-family:Open Sans;font-style:normal;font-weight:800;src:local("Open Sans ExtraBold "),local("Open Sans-ExtraBold"),url(/LG-Blog-Gatsby/static/open-sans-latin-800-aaeffaf205b9bbb09920089a14dbe9e8.woff2) format("woff2"),url(/LG-Blog-Gatsby/static/open-sans-latin-800-c6aa0c4a601fb6ac66f8253fa594dff5.woff) format("woff")}@font-face{font-display:swap;font-family:Open Sans;font-style:italic;font-weight:800;src:local("Open Sans ExtraBold italic"),local("Open Sans-ExtraBolditalic"),url(/LG-Blog-Gatsby/static/open-sans-latin-800italic-6b3973ffe02bb6a8be0f8453506ec032.woff2) format("woff2"),url(/LG-Blog-Gatsby/static/open-sans-latin-800italic-79b58175343190550489efe46a7f1138.woff) format("woff")}</style><style data-href="/LG-Blog-Gatsby/component---src-templates-post-template-js.e00996c3b58f2f9b9719.css">code[class*=language-],pre[class*=language-]{-moz-tab-size:4;-ms-hyphens:none;-o-tab-size:4;-webkit-hyphens:none;background:none;color:#f8f8f2;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;hyphens:none;line-height:1.5;tab-size:4;text-align:left;text-shadow:0 1px rgba(0,0,0,.3);white-space:pre;word-break:normal;word-spacing:normal;word-wrap:normal}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.0.21"/><style id="__jsx-3982648812">.item.jsx-3982648812,.showItem.jsx-3982648812{background:transparent;-webkit-transition:all 0.5s;-webkit-transition:all 0.5s;transition:all 0.5s;display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}
.item.jsx-3982648812 a,.showItem.jsx-3982648812 a{padding:10px;display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}
.item.jsx-3982648812 svg,.showItem.jsx-3982648812 svg{margin:0 5px 0 0;opacity:0.3;}
.itemList .hideItem{display:none;}
@media screen and (min-width:1024px){.item.jsx-3982648812 a{color:#3e3e3c;padding:10px;-webkit-transition:all 0.5s;-webkit-transition:all 0.5s;transition:all 0.5s;border-radius:5px;}.homepage:not(.fixed) .item.jsx-3982648812 a{color:#ffffff;}.item.jsx-3982648812 a:hover{color:#00a5e6;background:#ffffff;background:rgba(255,255,255,0.4);}.item.jsx-3982648812 svg{-webkit-transition:all 0.5s;-webkit-transition:all 0.5s;transition:all 0.5s;}.item.jsx-3982648812:hover svg{fill:#00a5e6;opacity:1;}.hero .item.jsx-3982648812:hover svg svg{fill:green;}.showItem.jsx-3982648812{display:none;}.hiddenItem.jsx-3982648812{text-align:left;padding:5px;}.hiddenItem.jsx-3982648812 a.inHiddenItem{color:#3e3e3c;}.hiddenItem.jsx-3982648812 a.inHiddenItem:hover{color:#00a5e6;}}</style><style id="__jsx-674193961">.menu.jsx-674193961{-webkit-box-align:center;-ms-flex-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background:#ffffff;bottom:0;display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex-positive:1;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;left:0;max-height:50px;padding:0 10px;position:fixed;width:100%;z-index:1;-webkit-transition:all 0.5s;-webkit-transition:all 0.5s;transition:all 0.5s;}
.itemList.jsx-674193961{display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;list-style:none;margin:0;padding:0;position:relative;width:100%;}
@media screen and (max-width:1023px){.menu.jsx-674193961:after{position:absolute;content:"";left:20px;right:20px;top:0;height:1px;background:#00a5e6;}.menu.open.jsx-674193961{padding:20px;}.homepage:not(.fixed) .menu.jsx-674193961{bottom:-100px;}}
@media screen and (min-width:1024px){.menu.jsx-674193961{border-top:none;background:transparent;display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:relative;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;padding-left:50px;-webkit-transition:none;-webkit-transition:none;transition:none;}.itemList.jsx-674193961{-webkit-box-pack:end;-ms-flex-pack:end;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;padding:0;}.hiddenItemList.jsx-674193961{list-style:none;margin:0;position:absolute;background:#ffffff;border:1px solid #ecebea;top:48px;right:10px;display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;padding:20px;border-radius:5px;border-top-right-radius:0;}.hiddenItemList.jsx-674193961:after{content:"";background:#ffffff;z-index:10;top:-10px;right:-1px;width:44px;height:10px;position:absolute;border-left:1px solid #ecebea;border-right:1px solid #ecebea;}.homepage:not(.fixed) .hiddenItemList.jsx-674193961{border:1px solid transparent;background:#ffffff;background:rgba(255,255,255,0.9);top:50px;}.homepage:not(.fixed) .hiddenItemList.jsx-674193961:after{top:-11px;border-left:1px solid transparent;border-right:1px solid transparent;background:#ffffff;background:rgba(255,255,255,0.9);}.fixed .hiddenItemList.jsx-674193961{top:44px;}}</style><style id="__jsx-768897745">.header.jsx-768897745{-webkit-box-align:center;-ms-flex-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ffffff;display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:80px;position:relative;top:0;width:100%;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}
.header.jsx-768897745 a.logoType{-webkit-box-align:center;-ms-flex-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:"column";-webkit-flex-direction:"column";-ms-flex-direction:"column";flex-direction:"column";color:#3e3e3c;}
.header.jsx-768897745 a.logoType .logo.jsx-768897745{-ms-flex-negative:0;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;}
.header.homepage.jsx-768897745{position:absolute;background-color:transparent;height:100px;;}
h1.jsx-768897745{font-size:1.35em;font-weight:400;margin:0 0 5px 0;}
h2.jsx-768897745{font-weight:400;font-size:.8em;-webkit-letter-spacing:0;-moz-letter-spacing:0;-ms-letter-spacing:0;letter-spacing:0;margin:0;}
.logo.jsx-768897745{border-radius:65% 75%;border:1px solid #eee;display:inline-block;height:44px;margin:0 20px 0 0;overflow:hidden;width:44px;-webkit-transition:all 0.5s;-webkit-transition:all 0.5s;transition:all 0.5s;}
.homepage.jsx-768897745 .logo.jsx-768897745{height:60px;width:60px;}
.logo.jsx-768897745 img.jsx-768897745{width:100%;}
.sensor.jsx-768897745{display:block;position:absolute;bottom:0;z-index:1;left:0;right:0;height:1px;top:80px;}
@media screen and (min-width:600px){.header.jsx-768897745{padding:40px;}.header.homepage.jsx-768897745{height:100px;;}}
@media screen and (max-width:1023px){.header.homepage.jsx-768897745 .logo.jsx-768897745{border:none;}.header.homepage.jsx-768897745 a.logoType,.header.homepage.jsx-768897745 h1.jsx-768897745{color:#ffffff;}.header.homepage.jsx-768897745 h2.jsx-768897745{color:#dddbda;}}
@media screen and (min-width:1024px){.header.jsx-768897745{-webkit-box-align:center;-ms-flex-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#ffffff;display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:absolute;top:0;width:100%;-webkit-box-pack:justify;-ms-flex-pack:justify;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-transition:padding 0.5s;-webkit-transition:padding 0.5s;transition:padding 0.5s;}.header.fixed.jsx-768897745{height:50px;;background-color:#ffffff;left:0;padding:0 20px;position:fixed;top:0;width:100%;z-index:1;}.header.fixed.jsx-768897745 h1.jsx-768897745{margin:0 0 2px 0;}.header.fixed.jsx-768897745 h2.jsx-768897745{display:none;}.header.homepage.jsx-768897745:not(.fixed) a.logoType,.header.homepage.jsx-768897745:not(.fixed) h1.jsx-768897745{color:#ffffff;}.header.homepage.jsx-768897745:not(.fixed) h2.jsx-768897745{color:#dddbda;}.header.jsx-768897745 a.logoType{text-align:left;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-ms-flex-negative:0;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:auto;}.logo.jsx-768897745{margin:0 20px 0 0;}.fixed.jsx-768897745 .logo.jsx-768897745{height:36px;width:36px;}.header.homepage.jsx-768897745:not(.fixed) .logo.jsx-768897745{border:none;}h2.jsx-768897745{-webkit-animation-duration:0.5s;-webkit-animation-duration:0.5s;animation-duration:0.5s;-webkit-animation-name:h2Entry;-webkit-animation-name:h2Entry-jsx-768897745;animation-name:h2Entry-jsx-768897745;}@-webkit-keyframes h2Entry{from.jsx-768897745{opacity:0;}to.jsx-768897745{opacity:1;}}@-webkit-keyframes h2Entry-jsx-768897745{from{opacity:0;}to{opacity:1;}}@keyframes h2Entry-jsx-768897745{from{opacity:0;}to{opacity:1;}}}</style><style id="__jsx-3306258923">h1.jsx-3306258923{font-size:2.2em;margin:0 0 40px 0;-webkit-animation-name:headlineEntry;-webkit-animation-name:headlineEntry-jsx-3306258923;animation-name:headlineEntry-jsx-3306258923;-webkit-animation-duration:1s;-webkit-animation-duration:1s;animation-duration:1s;}
h1.jsx-3306258923 span{font-weight:400;display:block;font-size:0.5em;-webkit-letter-spacing:0;-moz-letter-spacing:0;-ms-letter-spacing:0;letter-spacing:0;margin:0 0 5px 0;}
h1.jsx-3306258923 svg{height:0.75em;fill:#00a5e6;}
@-webkit-keyframes headlineEntry{from.jsx-3306258923{opacity:0.5;}to.jsx-3306258923{opacity:1;}}
@-webkit-keyframes headlineEntry-jsx-3306258923{from{opacity:0.5;}to{opacity:1;}}
@keyframes headlineEntry-jsx-3306258923{from{opacity:0.5;}to{opacity:1;}}
@media screen and (min-width:600px){h1.jsx-3306258923{font-size:calc(2em * 1.2);}}
@media screen and (min-width:1024px){h1.jsx-3306258923{font-size:calc(2em * 1.4);}}</style><style id="__jsx-2889715964">.meta.jsx-2889715964{display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;-ms-flex-flow:row wrap;flex-flow:row wrap;font-size:0.8em;margin:20px 0;background:transparent;}
.meta.jsx-2889715964 svg{fill:#00a5e6;margin:0 5px 0 0;}
.meta.jsx-2889715964 span.jsx-2889715964{-webkit-box-align:center;-ms-flex-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:5px 10px 5px 0;}
@media screen and (min-width:600px){.meta.jsx-2889715964{margin:calc(20px * 1.5) 0 20px;}}</style><style id="__jsx-2925212198">.bodytext.jsx-2925212198{-webkit-animation-name:bodytextEntry;-webkit-animation-name:bodytextEntry-jsx-2925212198;animation-name:bodytextEntry-jsx-2925212198;-webkit-animation-duration:1s;-webkit-animation-duration:1s;animation-duration:1s;}
.bodytext.jsx-2925212198 h2,.bodytext.jsx-2925212198 h3{margin:1.5em 0 1em;}
.bodytext.jsx-2925212198 h2{line-height:1.2;font-size:1.7em;}
.bodytext.jsx-2925212198 h3{font-size:1.35em;line-height:1.3;}
.bodytext.jsx-2925212198 p{font-size:1.1em;line-height:1.6;margin:0 0 1.5em;}
.bodytext.jsx-2925212198 ul{list-style:circle;margin:0 0 1.5em;padding:0 0 0 1.5em;}
.bodytext.jsx-2925212198 li{margin:0.7em 0;line-height:1.5;}
.bodytext.jsx-2925212198 a{font-weight:600;color:#00a5e6;-webkit-text-decoration:underline;text-decoration:underline;}
.bodytext.jsx-2925212198 a.gatsby-resp-image-link{border:0;display:block;margin:2.5em 0;border-radius:10px;overflow:hidden;border:1px solid #ecebea;}
.bodytext.jsx-2925212198 code.language-text{background:#ecebea;text-shadow:none;color:inherit;padding:0.1em 0.3em 0.2em;border-radius:0.1em;}
@-webkit-keyframes bodytextEntry{from.jsx-2925212198{opacity:0;}to.jsx-2925212198{opacity:1;}}
@-webkit-keyframes bodytextEntry-jsx-2925212198{from{opacity:0;}to{opacity:1;}}
@keyframes bodytextEntry-jsx-2925212198{from{opacity:0;}to{opacity:1;}}</style><style id="__jsx-3827537667">.gotop.jsx-3827537667{position:fixed;right:20px;bottom:-10px;-webkit-transition:all 1s;-webkit-transition:all 1s;transition:all 1s;cursor:pointer;}
.gotop.isShowTop.jsx-3827537667{opacity:1;-webkit-transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}
.gotop.jsx-3827537667{opacity:0;-webkit-transform:translateY(100%);-webkit-transform:translateY(100%);-ms-transform:translateY(100%);transform:translateY(100%);}
.gotop.jsx-3827537667:hover{-webkit-transform:rotate(1deg);-webkit-transform:rotate(1deg);-ms-transform:rotate(1deg);transform:rotate(1deg);}
#backToTop.jsx-3827537667{position:fixed;right:0px;top:-900px;width:70px;height:900px;background:url(/LG-Blog-Gatsby/static/line-73cb43199ea69a76e36ba5b0990e97e4.png);-webkit-transition:all .5s ease-in-out;-webkit-transition:all .5s ease-in-out;transition:all .5s ease-in-out;}</style><style id="__jsx-126278577">.links.jsx-126278577{display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:0 20px 40px;border-bottom:1px solid #ecebea;margin:0 0 40px 0;}
.links.jsx-126278577 a{display:-webkit-box;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}
.links.jsx-126278577 a:nth-child(2){margin:20px 0 0;}
.links.jsx-126278577 svg{fill:orange;width:20px;height:20px;-ms-flex-negative:0;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-box-flex:0;-ms-flex-positive:0;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;margin:0 20px 0 0;}
h4.jsx-126278577{font-weight:600;margin:0;font-size:1.1em;}
time.jsx-126278577{color:#969492;display:block;font-weight:400;font-size:0.8em;margin-top:0.5em;}
@media screen and (min-width:1024px){.links.jsx-126278577{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;-webkit-flex-direction:row-reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.links.jsx-126278577 a{-ms-flex-preferred-size:50%;-webkit-flex-basis:50%;-ms-flex-preferred-size:50%;flex-basis:50%;}.links.jsx-126278577 a:nth-child(2){margin:0;}.links.jsx-126278577 svg{-webkit-transition:all 0.5s;-webkit-transition:all 0.5s;transition:all 0.5s;margin:0 10px 0 0;}@media (hover:hover){.links.jsx-126278577 a:hover svg{-webkit-transform:scale(1.5);-webkit-transform:scale(1.5);-ms-transform:scale(1.5);transform:scale(1.5);}}}</style><style id="__jsx-1766939654">.article.jsx-1766939654{padding:20px;margin:0 auto;}
@media screen and (min-width:600px){.article.jsx-1766939654{padding:calc(20px) calc(20px * 2);max-width:650px;}}
@media screen and (min-width:1024px){.article.jsx-1766939654{padding:calc(20px * 2 + 90px) 0 calc(20px * 2);max-width:700px;}}</style><style id="__jsx-2344609357">.footer.jsx-2344609357{background:#ffffff;padding:20px;padding-top:0;padding-bottom:120px;}
.footer.jsx-2344609357 ul{list-style:none;text-align:center;padding:0;}
.footer.jsx-2344609357 ul li{color:#969492;font-size:.8em;padding:2px 10px;position:relative;display:inline-block;}
.footer.jsx-2344609357 ul li:after{content:"•";position:absolute;right:calc(5px * -1);}
.footer.jsx-2344609357 ul li:last-child:after{content:"";}
@media screen and (min-width:1024px){.footer.jsx-2344609357{padding:0 1em 1.5em;}}</style><style id="__jsx-3017011455">main.jsx-3017011455{min-height:80vh;}</style><style id="__jsx-3148707342">html{-webkit-box-sizing:border-box;box-sizing:border-box;}
*,*:after,*:before{-webkit-box-sizing:inherit;box-sizing:inherit;margin:0;padding:0;}
body{font-family:Arial, sans-serif;;}
h1,h2,h3{font-weight:400;line-height:1.1;-webkit-letter-spacing:-0.03em;-moz-letter-spacing:-0.03em;-ms-letter-spacing:-0.03em;letter-spacing:-0.03em;margin:0;}
h1{-webkit-letter-spacing:-0.04em;-moz-letter-spacing:-0.04em;-ms-letter-spacing:-0.04em;letter-spacing:-0.04em;}
p{margin:0;}
strong{font-weight:400;}
a{-webkit-text-decoration:none;text-decoration:none;color:#666;}
main{width:auto;display:block;}</style><title data-react-helmet="true">LGL - LG-Blog</title><meta data-react-helmet="true" name="description" content="LG-Blog"/><meta data-react-helmet="true" property="og:url" content="www.todaylg.com/LG-Blog-Gatsby//lgl/"/><meta data-react-helmet="true" property="og:title" content="LGL - LG-Blog"/><meta data-react-helmet="true" property="og:description" content="LG-Blog"/><meta data-react-helmet="true" property="og:image" content="[object Object]"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="WebAMV"/><link rel="manifest" href="/LG-Blog-Gatsby/manifest.webmanifest"/><meta name="theme-color" content="#666"/><link rel="alternate" type="application/rss+xml" href="/LG-Blog-Gatsby/rss.xml"/><link as="script" rel="preload" href="/LG-Blog-Gatsby/0-c0983f293ccd2b817b46.js"/><link as="script" rel="preload" href="/LG-Blog-Gatsby/component---src-templates-post-template-js-8e85dd8dc3a92e7303c1.js"/><link as="script" rel="preload" href="/LG-Blog-Gatsby/app-bab684d8b8f29b3f4d28.js"/><link as="script" rel="preload" href="/LG-Blog-Gatsby/webpack-runtime-ee5c99529da3fc26e898.js"/><link rel="preload" href="/LG-Blog-Gatsby/static/d/887/path---lgl-143-594-R1pWcLuFpkaMpwUVW6Az9zvKP6g.json" as="fetch" crossOrigin="use-credentials"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="#D0E0D8"/><meta name="apple-mobile-web-app-title" content="Lazywill"/><link rel="apple-touch-icon" href="/icons/apple-icon-57x57.png" sizes="57x57"/><link rel="apple-touch-icon" href="/icons/apple-icon-60x60.png" sizes="60x60"/><link rel="apple-touch-icon" href="/icons/apple-icon-72x72.png" sizes="72x72"/><link rel="apple-touch-icon" href="/icons/apple-icon-76x76.png" sizes="76x76"/><link rel="apple-touch-icon" href="/icons/apple-icon-114x114.png" sizes="114x114"/><link rel="apple-touch-icon" href="/icons/apple-icon-120x120.png" sizes="120x120"/><link rel="apple-touch-icon" href="/icons/apple-icon-144x144.png" sizes="144x144"/><link rel="apple-touch-icon" href="/icons/apple-icon-152x152.png" sizes="152x152"/><link rel="apple-touch-icon" href="/icons/apple-icon-180x180.png" sizes="180x180"/><link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><header class="jsx-768897745 header  "><a class="logoType" href="/LG-Blog-Gatsby/"><div class="jsx-768897745 logo"><img src="/LG-Blog-Gatsby/static/avatar-421bc1a993c325eb033296a4b73eee0c.jpg" alt="LG-Blog" class="jsx-768897745"/></div><div class="jsx-768897745 type"><h1 class="jsx-768897745">todaylg</h1><h2 class="jsx-768897745"></h2></div></a><nav rel="js-menu" class="jsx-674193961 menu "><ul class="jsx-674193961 itemList"><li class="jsx-3982648812 item"><a class="" data-slug="/" href="/LG-Blog-Gatsby/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em"><path d="M488 312.7V456c0 13.3-10.7 24-24 24H348c-6.6 0-12-5.4-12-12V356c0-6.6-5.4-12-12-12h-72c-6.6 0-12 5.4-12 12v112c0 6.6-5.4 12-12 12H112c-13.3 0-24-10.7-24-24V312.7c0-3.6 1.6-7 4.4-9.3l188-154.8c4.4-3.6 10.8-3.6 15.3 0l188 154.8c2.7 2.3 4.3 5.7 4.3 9.3zm83.6-60.9L488 182.9V44.4c0-6.6-5.4-12-12-12h-56c-6.6 0-12 5.4-12 12V117l-89.5-73.7c-17.7-14.6-43.3-14.6-61 0L4.4 251.8c-5.1 4.2-5.8 11.8-1.6 16.9l25.5 31c4.2 5.1 11.8 5.8 16.9 1.6l235.2-193.7c4.4-3.6 10.8-3.6 15.3 0l235.2 193.7c5.1 4.2 12.7 3.5 16.9-1.6l25.5-31c4.2-5.2 3.4-12.7-1.7-16.9z"></path></svg> <!-- -->Home</a></li><li class="jsx-3982648812 item"><a class="" data-slug="/category/" href="/LG-Blog-Gatsby/category/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"></path></svg> <!-- -->Categories</a></li><li class="jsx-3982648812 item"><a class="" data-slug="/contact/" href="/LG-Blog-Gatsby/contact/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg> <!-- -->About</a></li></ul></nav></header><div class="jsx-768897745 sensor"></div><main class="jsx-3017011455 jsx-3148707342"><article class="jsx-1766939654 article"><header><h1 class="jsx-3306258923">LGL</h1><p class="jsx-2889715964 meta"><span class="jsx-2889715964"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" size="18" height="18" width="18"><path d="M12 192h424c6.6 0 12 5.4 12 12v260c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V204c0-6.6 5.4-12 12-12zm436-44v-36c0-26.5-21.5-48-48-48h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v36c0 6.6 5.4 12 12 12h424c6.6 0 12-5.4 12-12z"></path></svg> <!-- -->2019-03-04</span><span class="jsx-2889715964"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" size="18" height="18" width="18"><path d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"></path></svg> <!-- -->todaylg</span><span class="jsx-2889715964"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" size="18" height="18" width="18"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"></path></svg><a href="/LG-Blog-Gatsby/category/大结">大结</a></span></p></header><div class="jsx-2925212198 bodytext"><h2>前言</h2>
<p>转眼间2018年就过去了，自己也结束了通信生涯正式变为了“社畜”。7月份拿到毕业证回到公司后，便是深陷各种业务需求，平时回到寒舍便是早已筋疲力竭，周末再补觉续命+打打游戏，一年下来积累沉淀得相比于学生时代是少之又少，实为惭愧。</p>
<p>游戏戒是不可能戒了，还没经住毒瘤同事和G胖眼神的安利与诱惑，Switch、Steam游戏还买了一堆，成为了又一位海拉鲁大陆观光团成员。。。</p>
<p>虽说多玩点游戏增长下画面渲染的见识总是好的嘛（逃。。）</p>
<p>转行任务是十分艰巨呀。。</p>
<p>最后还是决定即使照是葫芦画瓢也好，学着搂一个自己的渲染器，这样也能算是较为系统的一步步补全相关图形学知识。</p>
<p>老样子，先上瓢：<a href="https://github.com/todaylg/LGL">LGL</a>（名字就不提了哈哈）</p>
<p>葫芦主要是<a href="https://github.com/oframe/ogl">ogl</a>和<a href="https://github.com/mrdoob/three.js">three.js</a>，Three.js自不必多说，已经是Web3D框架的代表了吧。ogl则是一个低抽象级的小型WebGL库，语法直接使用的ES6+，麻雀虽小但是五脏俱全，非常适合用来学习取经，并且正好其还处于beta版本，缺的功能后面也正好直接补上。</p>
<h2>LGL整体结构</h2>
<p>分为Core、Math、Extras三个大模块，Core与Math为核心功能，Extras为封装的一些扩展功能。</p>
<p>Core目前包含以下模块：</p>
<ul>
<li>
<p>Renderer  根据配置创建WebGL Renderer，并控制整个渲染队列的渲染</p>
</li>
<li>
<p>Transform  变换物体基类</p>
</li>
<li>
<p>Camera  根据配置创建相机，继承Transform</p>
</li>
<li>
<p>Program  根据shader及配置输入创建并设置好WebGL的program对象</p>
</li>
<li>
<p>Geometry 几何图形基类，根据输入的顶点信息创建几何图元</p>
</li>
<li>
<p>Texture  根据配置创建材质对象</p>
</li>
<li>
<p>Mesh  对Geometry+Program的多一层封装抽象</p>
</li>
<li>
<p>RenderTarget 创建基本的渲染缓冲目标</p>
</li>
</ul>
<p>Math目前包含以下模块：</p>
<ul>
<li>
<p>Vec2  二维向量</p>
</li>
<li>
<p>Vec3  三维向量</p>
</li>
<li>
<p>Vec4  四维向量</p>
</li>
<li>
<p>Color  色值</p>
</li>
<li>
<p>Euler  欧拉角</p>
</li>
<li>
<p>Mat3  三维矩阵</p>
</li>
<li>
<p>Mat4  四维矩阵</p>
</li>
<li>
<p>Quat  四元数</p>
</li>
</ul>
<p>Extras目前包含以下模块：</p>
<ul>
<li>
<p>Orbit  Camera 轨道控制</p>
</li>
<li>
<p>Plane  平面几何体</p>
</li>
<li>
<p>Cube  立方体</p>
</li>
<li>
<p>Sphere  球体</p>
</li>
<li>
<p>Torus  圆环几何体</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled> Text  文本</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled> Post  后期处理</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled> glTFLoader  glTF格式加载器</p>
</li>
</ul>
<p>具体到每个方法的用途的话，已经在文档给出了注释：<a href="http://todaylg.com/LGL/docs/">Document</a></p>
<p>这里介绍一波：<a href="%5Bhttps://github.com/jsdoc3/jsdoc">jsDoc</a> 养成良好的注释编写习惯，连写文档的功夫都省啦~</p>
<p>下面是对模块中的一些具体计算原理及方法做记录及介绍：</p>
<h2>Math</h2>
<hr>
<p>首先从最为独立的Math模块开始，一些基本的数学计算代表的几何意义是需要熟悉和掌握的，这比单纯的记忆公式去死算更有意义：</p>
<h3>基础知识</h3>
<h4>向量（Vector）</h4>
<p>一组有序实数组，对应空间中一个有方向的长度，一个特定变换的概念性记号（线性变换的物质载体）</p>
<p><code class="language-text">vec3 (a1,a2,a3)</code></p>
<p><strong>线性代数紧紧围绕向量加法与数乘</strong></p>
<h4>张成空间（span）：</h4>
<p>所有可以表示为给定向量线性组合的向量的集合，称为给定向量的张成空间。</p>
<p>比如：单个向量张成空间为一条直线，两个向量张成空间为二维平面（不考虑共线），三个向量张成空间为三维空间（不考虑共线共面）。</p>
<h4>线性相关：</h4>
<p>一个向量可以表示为其他向量的线性组合（即这个向量已经落在其他向量的张成空间中），称它们为线性相关。</p>
<p>或者表述为：有多个向量时，移除其中一个而不减小张成空间，则它们线性相关。</p>
<h4>线性无关：</h4>
<p>可想而知，如果所有向量都给张成空间带来了新的维度，则它们线性无关</p>
<h4>基</h4>
<p>向量空间的一组基是张成该空间的一个线性无关向量集</p>
<h4>线性变换：</h4>
<p>保持网格线平行且等距分布，并且保持原点不动的变换（这两个条件下可以确保变换后的向量与变换后的单位向量是同样的线性组合）。</p>
<p><code class="language-text">v = -1i + 2j</code></p>
<p><code class="language-text">Transformed v = -1(Transform i) + 2(Transform j)</code></p>
<p>可以知道一个二维线性变换仅仅需要四个数字就可以确定（即变换后单位向量i与j的xy坐标)）</p>
<h4>矩阵（Matrix）</h4>
<p>而所谓的矩阵，其实就是描述一个对空间进行线性变换的信息</p>
<p>比如二维矩阵(三维同理)，可以理解为变换后单位向量坐标的组合(a,c)i ，(b,d)j</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token keyword">mat2</span> mat <span class="token operator">=</span> <span class="token punctuation">[</span>
    a b
    c d
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">vec2</span> vec <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">]</span><span class="token punctuation">;</span>
mat<span class="token operator">*</span>vec <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">*</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token operator">*</span><span class="token punctuation">[</span>b<span class="token punctuation">,</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>ax<span class="token operator">+</span>by<span class="token punctuation">,</span>cx<span class="token operator">+</span>dy<span class="token punctuation">)</span></code></pre></div>
<p>比如逆时针旋转90°的变换，x轴单位向量i的坐标就变成了(0,1)，y轴单位向量j的坐标就变成了(-1,0)，那变换矩阵即为：</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token punctuation">[</span>
    <span class="token number">0</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token number">1</span>  <span class="token number">0</span>
<span class="token punctuation">]</span></code></pre></div>
<p>非方阵变换也一样，只不过代表的是不同维度之间的映射：</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token punctuation">[</span>
  <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span>
 <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>
 <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span>
<span class="token comment">//这个变换即代表将i变换到（2,-1,-2）,j变换到（0,1,1），从二维空间到三维空间的映射</span></code></pre></div>
<h4>复合变换</h4>
<p>矩阵相乘代表着多个线性变换相继作用（需要注意顺序是从右往左）</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token keyword">mat2</span> m1 <span class="token operator">=</span> <span class="token punctuation">[</span>
    a b
    c d
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">mat2</span> m2 <span class="token operator">=</span> <span class="token punctuation">[</span>
    e f
    g h
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//最终方向向量i：</span>
<span class="token punctuation">(</span>xi<span class="token punctuation">,</span>yi<span class="token punctuation">)</span> <span class="token operator">=</span> m1<span class="token operator">*</span><span class="token punctuation">[</span>e<span class="token punctuation">,</span>g<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">[</span>a<span class="token punctuation">,</span>c<span class="token punctuation">]</span><span class="token operator">+</span>g<span class="token punctuation">[</span>b<span class="token punctuation">,</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>ae<span class="token operator">+</span>bg<span class="token punctuation">,</span>ce<span class="token operator">+</span>dg<span class="token punctuation">]</span>
<span class="token comment">//最终方向向量j：</span>
<span class="token punctuation">(</span>xj<span class="token punctuation">,</span>yj<span class="token punctuation">)</span> <span class="token operator">=</span> m1<span class="token operator">*</span><span class="token punctuation">[</span>f<span class="token punctuation">,</span>h<span class="token punctuation">]</span> <span class="token operator">=</span> f<span class="token punctuation">[</span>a<span class="token punctuation">,</span>c<span class="token punctuation">]</span><span class="token operator">+</span>h<span class="token punctuation">[</span>b<span class="token punctuation">,</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>af<span class="token operator">+</span>bh<span class="token punctuation">,</span>cg<span class="token operator">+</span>dh<span class="token punctuation">]</span>
<span class="token comment">//即复合变换矩阵为：</span>
m1<span class="token operator">*</span>m2 <span class="token operator">=</span> <span class="token punctuation">[</span>
    ae<span class="token operator">+</span>bg<span class="token punctuation">,</span>ce<span class="token operator">+</span>dg
    af<span class="token operator">+</span>bh<span class="token punctuation">,</span>cg<span class="token operator">+</span>dh
<span class="token punctuation">]</span></code></pre></div>
<h4>行列式（determinant）</h4>
<p>线性变换改变面积（三维是体积）的比例，称之为这个变换的行列式</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token comment">//以单位向量的乘积（二维为面积为1的正方形，三维为体积为1的立方体）</span>
<span class="token function">det</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token number">0.0</span><span class="token punctuation">,</span><span class="token number">2.0</span>
    <span class="token operator">-</span><span class="token number">1.5</span><span class="token punctuation">,</span><span class="token number">1.0</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">3.0</span>

<span class="token function">det</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
 <span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0.5</span>
 <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">0.5</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.5</span>
<span class="token comment">//压缩成一条直线时(即将空间压缩到更小的维度时)，行列式为0</span>
<span class="token function">det</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
 <span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span>
 <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span></code></pre></div>
<p>变换之后i与j的左右关系若变化，则代表空间发生了翻转（三维及变换后不再符合右手法则），此时符号位为负，行列式也如此。</p>
<p>实际计算的公式为：</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token function">det</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
 a<span class="token punctuation">,</span>b
 c<span class="token punctuation">,</span>d
<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> ad <span class="token operator">-</span> bc
<span class="token comment">//(a,c)为单位向量i变换后xy坐标</span>
<span class="token comment">//(b,d)为单位向量j变换后xy坐标</span>
<span class="token comment">//当b与c都为0，变换后为矩形，面积为ad</span>
<span class="token comment">//当b或c为0，变换后为平行四边形，面积也为ad</span>
<span class="token comment">//当b与c都不为0时，得回到定义计算来解释：</span>
<span class="token comment">//(a+b)(c+d)-ac-bd-2bc=ad-bc</span>
<span class="token comment">//其实就是有坐标矩形减出变换后平行四边形面积，最后得到ad-bc</span></code></pre></div>
<h4>逆变换</h4>
<p>即经过变换和逆变换后回到原始状态</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl">A<span class="token operator">*</span>A<span class="token operator">^</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span></code></pre></div>
<p>在解线性方程组时：</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token comment">//det(A)!=0</span>
A<span class="token operator">*</span>x <span class="token operator">=</span> v
A<span class="token operator">^</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">*</span>A<span class="token operator">*</span>x <span class="token operator">=</span> A<span class="token operator">^</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">*</span>v
x <span class="token operator">=</span> A<span class="token operator">^</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">*</span>v</code></pre></div>
<h4>秩</h4>
<p>代表变换后列空间（列即代表基向量变换后的坐标）的维数。可知秩最大与列数相同。</p>
<h4>点积</h4>
<p>两个维数相同的向量的点积结果为相应坐标配对相乘再相加。</p>
<p>其几何意义为向量w在过零点和向量v直线上的投影，投影长度与向量v的长度相乘。（dot(v,w) = |v||w|cosθ)）</p>
<p>也可以以变换的观点理解，将其中一个向量转换为线性变换矩阵（x与y代表映射到一维数轴上后的单位向量i与j)，一维矩阵与向量相乘的数值运算与两个向量的点积是一致的。（对偶性：一个空间到数轴的线性变换，都能找到一个向量，称为这个变换的对偶向量）</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token function">dot</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">*</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">*</span><span class="token number">4</span>
<span class="token comment">//点积结果大于0，代表两个向量指向大致相同</span>
<span class="token comment">//点积结果等于0，代表两个向量互相垂直</span>
<span class="token comment">//点积结果大于0，代表两个向量指向相反</span></code></pre></div>
<h4>叉积</h4>
<p> 向量w于v的叉积结果为垂直于这两个向量所在平面的向量u，u的长度为w于v所张成的平行四边形的面积（二维），方向遵循右手定则。提到面积自然想到上面的行列式，所以计算方法：</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token comment">//二维向量叉积（数值代表面积）</span>
<span class="token function">cross</span><span class="token punctuation">(</span><span class="token keyword">vec2</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">vec2</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">det</span><span class="token punctuation">(</span><span class="token keyword">mat2</span><span class="token punctuation">[</span>
    a<span class="token punctuation">,</span>c
    b<span class="token punctuation">,</span>d
<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> ad <span class="token operator">-</span> bc  <span class="token comment">//方向垂直于（a,b）、（c,d）所在平面，遵循右手定则</span>
<span class="token comment">//三维向量叉积（数值代表体积）</span>
<span class="token function">cross</span><span class="token punctuation">(</span><span class="token keyword">vec3</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span>v2<span class="token punctuation">,</span>v3<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">vec3</span><span class="token punctuation">(</span>w1<span class="token punctuation">,</span>w2<span class="token punctuation">,</span>w3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">det</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    i<span class="token punctuation">,</span>v1<span class="token punctuation">,</span>w1
    j<span class="token punctuation">,</span>v2<span class="token punctuation">,</span>w2
    k<span class="token punctuation">,</span>v3<span class="token punctuation">,</span>w3
<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">i</span><span class="token punctuation">(</span>v2w3<span class="token operator">-</span>v3w2<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">j</span><span class="token punctuation">(</span>v3w1<span class="token operator">-</span>v1w3<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">k</span><span class="token punctuation">(</span>v1w2<span class="token operator">-</span>v2w1<span class="token punctuation">)</span></code></pre></div>
<h4>基变换</h4>
<p>通过矩阵变换(称为基变换矩阵 )完成两组不同基向量（i、j）的映射，逆矩阵则反向转换。</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token comment">//A为基向量变换矩阵，M为变换矩阵</span>
A<span class="token operator">^</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">*</span> M <span class="token operator">*</span> A <span class="token comment">//通常代表在另一坐标系中描述M变换</span></code></pre></div>
<h4>特征向量与特征值</h4>
<p>特征向量及在线性变换之后任停留在它张成空间（直线）里的向量，特征值则为衡量特征向量在变换中拉伸或压缩比例的因子。比如三维空间的旋转，其特征向量及为旋转轴（特征值为1，不压缩拉伸）。行列式与特征向量的好处在于其与所选的坐标系无关，并不会改变它们最根本的值</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl">A<span class="token operator">*</span>v <span class="token operator">=</span> λv <span class="token comment">//矩阵变换等于特征值与向量相乘（降维情况）</span>
A<span class="token operator">*</span>v<span class="token operator">-</span>λΙv <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">//I为单位矩阵</span>
<span class="token punctuation">(</span>A<span class="token operator">-</span>λΙ<span class="token punctuation">)</span>v <span class="token operator">=</span> <span class="token number">0</span>
<span class="token function">det</span><span class="token punctuation">(</span>A<span class="token operator">-</span>λΙ<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span></code></pre></div>
<h4>齐次坐标</h4>
<p>三维表示的点和向量可能会被搞混，齐次坐标可以解决这个问题，其对三维空间中的点和向量的表示都是四维的：</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token keyword">vec4</span> p <span class="token operator">=</span> <span class="token punctuation">[</span>a1<span class="token punctuation">,</span>a2<span class="token punctuation">,</span>a3<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//任意点</span>
<span class="token keyword">vec4</span> w <span class="token operator">=</span> <span class="token punctuation">[</span>b1<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>b3<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//任意向量</span></code></pre></div>
<p>所有的仿射变换（具有保持直线的特性）都可以借助其次坐标表示成矩阵相乘的形式。因为所有的仿射变换都可以用一致的形式来表示，所以在处理级联的情况，会比三维的表示方便得多。</p>
<h4>平移</h4>
<p>平移变换通过一个位移向量来移动点的位置</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token keyword">vec4</span> p <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//初始点  **写按行写，但是意思是列坐标描述点的坐标，左乘</span>
<span class="token keyword">vec4</span> d <span class="token operator">=</span> <span class="token punctuation">[</span>ax<span class="token punctuation">,</span>ay<span class="token punctuation">,</span>az<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//位移向量</span>
<span class="token keyword">vec4</span> p1 <span class="token operator">=</span> <span class="token punctuation">[</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span>z1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//位移终点</span>

x1 <span class="token operator">=</span> x <span class="token operator">+</span> ax<span class="token punctuation">;</span>
y1 <span class="token operator">=</span> y <span class="token operator">+</span> ay<span class="token punctuation">;</span>
z1 <span class="token operator">=</span> z <span class="token operator">+</span> az<span class="token punctuation">;</span>

<span class="token comment">//平移矩阵 T</span>
p1 <span class="token operator">=</span> T <span class="token operator">*</span> p<span class="token punctuation">;</span> <span class="token comment">//（行*列）</span>
<span class="token comment">//其中：</span>
<span class="token keyword">mat4</span> T <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>ax<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>ay<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>az<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>   <span class="token comment">//用于保持结果为齐次坐标形式</span>
<span class="token punctuation">]</span></code></pre></div>
<h4>缩放</h4>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl">p1 <span class="token operator">=</span> S <span class="token operator">*</span> p<span class="token punctuation">;</span>

x1 <span class="token operator">=</span> x<span class="token operator">*</span>bx<span class="token punctuation">;</span>
y1 <span class="token operator">=</span> y<span class="token operator">*</span>by<span class="token punctuation">;</span>
z1 <span class="token operator">=</span> z<span class="token operator">*</span>bz<span class="token punctuation">;</span>

<span class="token comment">//其中</span>
<span class="token keyword">mat4</span> S <span class="token operator">=</span> <span class="token punctuation">[</span>
    bx<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span>
    <span class="token number">0</span><span class="token punctuation">,</span>by<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>bz<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span></code></pre></div>
<h4>旋转</h4>
<p>旋转会复杂一些，需要旋转点（不动点）、制定旋转轴方向的一个向量、旋转的角度。</p>
<p>可以参考：<a href="https://blog.csdn.net/csxiaoshui/article/details/65446125">https://blog.csdn.net/csxiaoshui/article/details/65446125</a></p>
<p>由简单的条件下一步一步推导至通用的旋转矩阵</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token comment">//1.绕原点的二维旋转</span>
<span class="token comment">//极坐标公式：</span>
x<span class="token operator">=</span>rcosϕ
y<span class="token operator">=</span>rsinϕ
<span class="token comment">//三角函数正弦余弦公式：</span>
x′<span class="token operator">=</span><span class="token function">rcos</span><span class="token punctuation">(</span>θ<span class="token operator">+</span>ϕ<span class="token punctuation">)</span><span class="token operator">=</span>rcosθcosϕ−rsinθsinϕ
y′<span class="token operator">=</span><span class="token function">rsin</span><span class="token punctuation">(</span>θ<span class="token operator">+</span>ϕ<span class="token punctuation">)</span><span class="token operator">=</span>rsinθcosϕ<span class="token operator">+</span>rcosθsinϕ
<span class="token comment">//代入x、y</span>
x′<span class="token operator">=</span>xcosθ−ysinθ  
y′<span class="token operator">=</span>xsinθ<span class="token operator">+</span>ycosθ  
<span class="token comment">//矩阵表示</span>
<span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> R <span class="token operator">*</span> <span class="token punctuation">[</span>x′<span class="token punctuation">,</span> y′<span class="token punctuation">]</span>
<span class="token keyword">mat2</span> R <span class="token operator">=</span> <span class="token punctuation">[</span>
    cosθ<span class="token punctuation">,</span>−sinθ
    sinθ<span class="token punctuation">,</span>cosθ
<span class="token punctuation">]</span>
<span class="token comment">//2.绕任意点的二维旋转</span>
<span class="token comment">//级联上两次位移矩阵即可（旋转点位移至原点 => 绕原点旋转 => 旋转点移回原位）</span>
v’<span class="token operator">=</span><span class="token function">T</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">*</span>R<span class="token operator">*</span><span class="token function">T</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">,</span><span class="token operator">-</span>y<span class="token punctuation">)</span>
<span class="token comment">//引入三维齐次坐标</span>
<span class="token keyword">mat3</span> M <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>tx<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>ty<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">[</span>
    cosθ<span class="token punctuation">,</span>−sinθ<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    sinθ<span class="token punctuation">,</span>cosθ<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span><span class="token operator">*</span> <span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>tx<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span>ty<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    cosθ<span class="token punctuation">,</span>−sinθ<span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1</span>−cosθ<span class="token punctuation">)</span>tx<span class="token operator">+</span>ty∗sinθ<span class="token punctuation">,</span>
    sinθ<span class="token punctuation">,</span>cosθ<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1</span>−cosθ<span class="token punctuation">)</span>ty−tx∗sinθ<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span>
<span class="token comment">//3.三维基本旋转</span>
<span class="token comment">//引入四维齐次坐标</span>
<span class="token comment">//绕X轴的旋转：</span>
x′<span class="token operator">=</span>x
y′<span class="token operator">=</span>ycosθ−zsinθ
z′<span class="token operator">=</span>ysinθ<span class="token operator">+</span>zcosθ
<span class="token comment">//矩阵表示</span>
<span class="token keyword">mat4</span> Mx <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span>cosθ<span class="token punctuation">,</span>−sinθ<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span>sinθ<span class="token punctuation">,</span>cosθ<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span>
<span class="token comment">//同理可求得绕Y轴旋转的矩阵My，绕Z轴旋转的矩阵Mz</span>
<span class="token comment">//任何旋转点在原点的旋转矩阵都可以表示成Mx、My、Mz三个旋转矩阵的级联</span>
<span class="token comment">//可以将任意旋转轴旋转到与X/Y/Z某一轴重合，执行基本旋转，之后再执行反向旋转恢复旋转轴方向</span></code></pre></div>
<h4>错切</h4>
<p>错切（shear）由角度θ来表征，比如x错切：</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl">x1 <span class="token operator">=</span> x <span class="token operator">+</span> y<span class="token operator">*</span><span class="token function">cot</span><span class="token punctuation">(</span>θ<span class="token punctuation">)</span><span class="token punctuation">;</span>
y1 <span class="token operator">=</span> y<span class="token punctuation">;</span>
z1 <span class="token operator">=</span> z<span class="token punctuation">;</span>

<span class="token comment">//错切矩阵</span>
<span class="token keyword">mat4</span> Hx <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span><span class="token function">cot</span><span class="token punctuation">(</span>θ<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span></code></pre></div>
<h4>欧拉角</h4>
<p>欧拉角是通过制定三个与旋转轴相关的角度以表示任意方向的方法。zX顺规：</p>
<ul>
<li>
<p>物体绕全局的 z 轴旋转角 α</p>
</li>
<li>
<p>继续绕自己的 X 轴旋转角 β</p>
</li>
<li>
<p>最后绕自己的 Z 轴旋转角 γ</p>
</li>
</ul>
<p>万向节死锁（Gimbal Lock）：</p>
<p><a href="https://zh.wikipedia.org/wiki/%E7%92%B0%E6%9E%B6%E9%8E%96%E5%AE%9A">https://zh.wikipedia.org/wiki/%E7%92%B0%E6%9E%B6%E9%8E%96%E5%AE%9A</a></p>
<p>角度为±90°的第二次旋转使得第一次和第三次旋转的旋转轴相同的现象（丧失了一个自由度），称作万向锁。</p>
<p><a href="https://www.youtube.com/watch?v=rsKy-4dbA04">https://www.youtube.com/watch?v=rsKy-4dbA04</a></p>
<p><a href="https://www.matongxue.com/madocs/442.html">https://www.matongxue.com/madocs/442.html</a></p>
<p>附：飞行器旋转的专业的术语</p>
<ul>
<li>
<p>偏航（Yaw），围绕机头上方轴旋转（左右摇头）</p>
</li>
<li>
<p>俯仰（Pitch），围绕机身右方轴旋转（上下点头）</p>
</li>
<li>
<p>桶滚（Roll），围绕机头前方轴旋转（左右摆头）</p>
</li>
</ul>
<h4>四元数</h4>
<p>对二维的情形，通常会使用复数来表示旋转的变换：</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token comment">//欧拉公式（i^2 = -1）</span>
e<span class="token operator">^</span>iθ <span class="token operator">=</span> cosθ <span class="token operator">+</span> isinθ
<span class="token comment">//复数c的极坐标可以写成 (r^2 = a^2 + b^2)</span>
c <span class="token operator">=</span> a <span class="token operator">+</span> ib <span class="token operator">=</span> re<span class="token operator">^</span><span class="token punctuation">(</span>iθ<span class="token punctuation">)</span>
<span class="token comment">//设旋转角度为φ</span>
c′ <span class="token operator">=</span> re<span class="token operator">^</span><span class="token function">i</span><span class="token punctuation">(</span>θ<span class="token operator">+</span>φ<span class="token punctuation">)</span>  <span class="token operator">=</span> re<span class="token operator">^</span><span class="token punctuation">(</span>iθ<span class="token punctuation">)</span>e<span class="token operator">^</span><span class="token punctuation">(</span>iφ<span class="token punctuation">)</span> <span class="token comment">//e^(iφ)即为复平面的一个旋转算子</span></code></pre></div>
<p>对于三维的情况，确定一个以原点为旋转点（不是的话可以级联位移矩阵）的三维旋转，需要指定一个旋转方向（向量）和旋转角度（标量），使用一种即包含向量又包含标量的表示，称为四元数形式：</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token keyword">vec4</span> a <span class="token operator">=</span> <span class="token punctuation">(</span>q0<span class="token punctuation">,</span>q1<span class="token punctuation">,</span>q2<span class="token punctuation">,</span>q3<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>q0<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//q为三维向量</span></code></pre></div>
<p>具体介绍可参考：</p>
<p><a href="https://www.zhihu.com/question/23005815/answer/33971127">https://www.zhihu.com/question/23005815/answer/33971127</a></p>
<p><a href="https://zh.wikipedia.org/wiki/%E5%9B%9B%E5%85%83%E6%95%B8">https://zh.wikipedia.org/wiki/%E5%9B%9B%E5%85%83%E6%95%B8</a></p>
<h4>色值换算</h4>
<p><strong>HEX &#x3C;=> RGB</strong></p>
<p>Hex转RGB其实就是十六进制与十进制之间的转换，核心为 <code class="language-text">parseInt(&quot;FF&quot;, 16)</code></p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> r <span class="token operator">=</span> <span class="token regex">/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>hex<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>r <span class="token operator">=</span> r <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">this</span><span class="token punctuation">.</span>g <span class="token operator">=</span> r <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> r <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span></code></pre></div>
<p>RGB转Hex即十进制转十六进制，核心为<code class="language-text">Number(255).toString(16);</code></p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> hex <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>rgbArr<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>RGB &#x3C;=> HSL/HSV</strong></p>
<p>H指Hue(色调)。 0(或360)表示红色，120表示绿色，240表示蓝色，当然可取其他数值来确定其它颜色；<br>
S指Saturation(饱和度)。 取值为0%到100%之间的值；<br>
L指Lightness(亮度)。 取值为0%到100%之间的值；</p>
<p>参考换算公式：<a href="https://en.wikipedia.org/wiki/HSL_and_HSV">https://en.wikipedia.org/wiki/HSL<em>and</em>HSV</a></p>
<p><strong>CSS颜色关键字</strong></p>
<p>至于CSS颜色关键字的转换，可以像Three.js直接粗暴的罗列其与Hex格式的对应关系：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> ColorKeywords <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">'aliceblue'</span><span class="token punctuation">:</span> <span class="token number">0xF0F8FF</span><span class="token punctuation">,</span> <span class="token string">'antiquewhite'</span><span class="token punctuation">:</span> <span class="token number">0xFAEBD7</span><span class="token punctuation">,</span> <span class="token string">'aqua'</span><span class="token punctuation">:</span> <span class="token number">0x00FFFF</span><span class="token punctuation">,</span> <span class="token string">'aquamarine'</span><span class="token punctuation">:</span> <span class="token number">0x7FFFD4</span><span class="token punctuation">,</span> <span class="token string">'azure'</span><span class="token punctuation">:</span> <span class="token number">0xF0FFFF</span> <span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>或者借助DOM特性读取色值：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> color<span class="token punctuation">;</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> c <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>createDiv<span class="token punctuation">)</span><span class="token punctuation">.</span>backgroundColor<span class="token punctuation">;</span>    

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>之后再对读取出的字符串进行格式转化。</p>
<h2>模块划分</h2>
<p>Math模块基于 <a href="https://github.com/toji/gl-matrix">gl-Matrix</a> (column-major format)进行封装，对外暴露向量（Vec2、Vec3、Vec4）、矩阵（Mat3、Mat4）、欧拉角（Euler）、四元数（Quat）的一些基本运算方法。</p>
<p>没啥好说的，具体到每个方法的计算方法可以直接查看文档。</p>
<h2>Core</h2>
<hr>
<p>Core模块依赖Math模块，对WebGL API进行了封装和抽象。</p>
<p>对外暴露的API与Three.js有一些类似的地方，最大的区别在于Core部分不提供默认和可选的材质，即完全分离开了Shader部分。</p>
<p>这样做的好处显而易见，Core只用专注于控制物体的渲染队列即可，而不用耦合进各式各样的Shader片段。弊端也同样显而易见，需要自己为每个场景编写全部Shader，使用成本无疑高了很多。</p>
<h3>Transform</h3>
<p>Thansform相当于Three.js中的Object3D，是在场景中具体显示物体的基类，包含了基本的比如位置(Position)旋转(Rotate)缩放(Scale)等信息，提供了父子(Child/Parent)关系的抽象。</p>
<p>渲染框架基本都会提供父子对象的抽象，这样的好处是啥呢？</p>
<p>要到Renderer的遍历才够详细</p>
<h3>Camera</h3>
<p>确定相机的定位的计算需要得到</p>
<ul>
<li>
<p>VRP（Voew-Reference Point，观察参考点）</p>
</li>
<li>
<p>VPN（View-Plane Normal，观察平面法向量）</p>
</li>
<li>
<p>VUP（View-Up Vector，观察正向向量）</p>
</li>
</ul>
<p><strong>LookAt</strong></p>
<p>相机的位置称为视点（eye point），相机的方向指向一个点称为参考点（at point），这两个点确定了VPN和VRP。VRP自然就是视点，VPN则是视点和参考点相减再归一化即可得到。最后我们只需要再对照相机指定想要观察的正向（VUP）就OK了，所以lookAt函数一般暴露的API为：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"> <span class="token comment">/**
  * @function

  * @description  Generates a matrix that makes something look at something else.

  * @param {vec3} eye Position of the viewer

  * @param {vec3} target Point the viewer is looking at

  * @param {vec3} up vec3 pointing up

  * @returns {Mat4} 

*/</span>
<span class="token function">lookAt</span><span class="token punctuation">(</span>eye<span class="token punctuation">,</span> target<span class="token punctuation">,</span> up<span class="token punctuation">)</span> <span class="token punctuation">{</span>

   <span class="token operator">...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>具体是如何计算的呢？</p>
<p>首先明确Camera矩阵（View矩阵）的作用，是将世界坐标系中的物体的顶点坐标转换到摄像机坐标系。</p>
<p>转换步骤：</p>
<ul>
<li>
<p>整体平移，将相机视点平移至世界坐标系原点</p>
</li>
<li>
<p>将参考点从世界坐标系转换至相机坐标系</p>
</li>
</ul>
<p>即：<code class="language-text">ViewMatrix = R * T</code></p>
<p>1.首先求UVW：</p>
<p>首先W即为视线方向，normalize(target-eye)即可</p>
<p>V则可以通过叉乘up和W得到</p>
<p>U自然就是叉乘W和V即可</p>
<p>就可以求得坐标系矩阵：</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token keyword">mat4</span> R <span class="token operator">=</span> <span class="token punctuation">[</span>
    ux<span class="token punctuation">,</span>uy<span class="token punctuation">,</span>uz<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    vx<span class="token punctuation">,</span>vy<span class="token punctuation">,</span>vz<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    wx<span class="token punctuation">,</span>wy<span class="token punctuation">,</span>wz<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span>
<span class="token comment">//由eye可得平移矩阵</span>
<span class="token keyword">mat4</span> T<span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>eyeX<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>eyeY<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span>eyeZ<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span>
<span class="token comment">//最后的结果：</span>
<span class="token keyword">mat4</span> viewMatrix <span class="token operator">=</span> R <span class="token operator">*</span> T <span class="token operator">=</span> <span class="token punctuation">[</span>
    ux<span class="token punctuation">,</span>uy<span class="token punctuation">,</span>uz<span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">(</span>u0 <span class="token operator">*</span> eyex <span class="token operator">+</span> u1 <span class="token operator">*</span> eyey <span class="token operator">+</span> u2 <span class="token operator">*</span> eyez<span class="token punctuation">)</span><span class="token punctuation">,</span>
    vx<span class="token punctuation">,</span>vy<span class="token punctuation">,</span>vz<span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">(</span>v0 <span class="token operator">*</span> eyex <span class="token operator">+</span> v1 <span class="token operator">*</span> eyey <span class="token operator">+</span> v2 <span class="token operator">*</span> eyez<span class="token punctuation">)</span><span class="token punctuation">,</span>
    wx<span class="token punctuation">,</span>wy<span class="token punctuation">,</span>wz<span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">(</span>w0 <span class="token operator">*</span> eyex <span class="token operator">+</span> w1 <span class="token operator">*</span> eyey <span class="token operator">+</span> w2 <span class="token operator">*</span> eyez<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span></code></pre></div>
<p><strong>正交(orthographic)投影</strong></p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">/**
 * Generates a orthogonal projection matrix with the given bounds
 * @private
 * @param {mat4} out mat4 frustum matrix will be written into
 * @param {number} left Left bound of the frustum
 * @param {number} right Right bound of the frustum
 * @param {number} bottom Bottom bound of the frustum
 * @param {number} top Top bound of the frustum
 * @param {number} near Near bound of the frustum
 * @param {number} far Far bound of the frustum
 * @returns {mat4} out
 */</span>
<span class="token keyword">function</span> <span class="token function">ortho</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span> left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> bottom<span class="token punctuation">,</span> top<span class="token punctuation">,</span> near<span class="token punctuation">,</span> far<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>在WebGL中，默认的投影变换矩阵是单位矩阵（视见体是规范的立方体）。显然，为了得到一般的正交投影变换矩阵，我们只需找到将暴露出去ortho函数所指定的长方体映射成这个立方体的变换矩阵即可。</p>
<p>实施步骤：</p>
<ul>
<li>
<p>通过平移把指定视见体的中心移动到规范视见体的中心（原点）</p>
</li>
<li>
<p>缩放指定视见体使得每条边的长度都为2（+1 - -1）</p>
</li>
</ul>
<p>前面说的位移矩阵还有缩放矩阵就派上用场啦：</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl"><span class="token comment">//位移矩阵</span>
<span class="token keyword">mat4</span> T <span class="token operator">=</span> <span class="token punctuation">[</span>
 <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">(</span>r<span class="token operator">+</span>l<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">(</span>t<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">(</span>f<span class="token operator">+</span>n<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span>
<span class="token comment">//缩放矩阵</span>
<span class="token keyword">mat4</span> S <span class="token operator">=</span> <span class="token punctuation">[</span>
 <span class="token number">2</span><span class="token operator">/</span><span class="token punctuation">(</span>r<span class="token operator">-</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">/</span><span class="token punctuation">(</span>t<span class="token operator">-</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">/</span><span class="token punctuation">(</span>n<span class="token operator">-</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span>
<span class="token comment">//正交变换矩阵即为：</span>
<span class="token keyword">mat4</span> N <span class="token operator">=</span> S <span class="token operator">*</span> T <span class="token operator">=</span> <span class="token punctuation">[</span>
 <span class="token number">2</span><span class="token operator">/</span><span class="token punctuation">(</span>r<span class="token operator">-</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">(</span>r<span class="token operator">+</span>l<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>r<span class="token operator">-</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">/</span><span class="token punctuation">(</span>t<span class="token operator">-</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">(</span>t<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>t<span class="token operator">-</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">/</span><span class="token punctuation">(</span>f<span class="token operator">-</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">(</span>f<span class="token operator">+</span>n<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>f<span class="token operator">-</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span>
<span class="token comment">//如果视见体是对称的(r = -l, t = -b)，还可以进一步简化矩阵</span>
<span class="token keyword">mat4</span> N <span class="token operator">=</span> <span class="token punctuation">[</span>
 <span class="token number">1</span><span class="token operator">/</span>r<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>t<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">/</span><span class="token punctuation">(</span>f<span class="token operator">-</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">(</span>f<span class="token operator">+</span>n<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>f<span class="token operator">-</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
<span class="token punctuation">]</span></code></pre></div>
<p><strong>透视(perspective)投影</strong></p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">/**
 * Generates a perspective projection matrix with the given bounds
 * @private
 * @param {mat4} out mat4 frustum matrix will be written into
 * @param {number} fovy Vertical field of view in radians
 * @param {number} aspect Aspect ratio. typically viewport width/height
 * @param {number} near Near bound of the frustum
 * @param {number} far Far bound of the frustum
 * @returns {mat4} out
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">perspective</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span> fovy<span class="token punctuation">,</span> aspect<span class="token punctuation">,</span> near<span class="token punctuation">,</span> far<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>同样的思路，为了得到WebGL中(frustum)可以使用的透视投影变换矩阵，我们先将指定的棱台视见体变换为规范视见体：</p>
<ul>
<li>
<p>通过错切变换矩阵H</p>
</li>
<li>
<p>缩放变换矩阵S</p>
</li>
<li>
<p>投影规范化矩阵N</p>
</li>
</ul>
<p>通过错切变换矩阵H的目的是将不对称的棱台转化为对称的棱台：</p>
<p><code class="language-text">H = H(arccot((l+r)/-2*near,arccot((t+b)/-2*near))</code></p>
<p>缩放矩阵：</p>
<p><code class="language-text">S = S(-2*near/(r-l), -2*near/(t-b), 1)</code></p>
<p>投影规范化矩阵:</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">N <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span>
<span class="token punctuation">]</span></code></pre></div>
<p>三者级联即可得到最后的投影变换矩阵</p>
<div class="gatsby-highlight" data-language="glsl"><pre class="language-glsl"><code class="language-glsl">P <span class="token operator">=</span> N<span class="token operator">*</span>S<span class="token operator">*</span>H <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token operator">-</span><span class="token number">2</span>n<span class="token operator">/</span><span class="token punctuation">(</span>r<span class="token operator">-</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">(</span>r<span class="token operator">+</span>l<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>r<span class="token operator">-</span>l<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span>n<span class="token operator">/</span><span class="token punctuation">(</span>t<span class="token operator">-</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>t<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>t<span class="token operator">-</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">(</span>f<span class="token operator">+</span>n<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>f<span class="token operator">-</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2f</span>n<span class="token operator">/</span>f<span class="token operator">-</span>n<span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span>
<span class="token punctuation">]</span>
<span class="token comment">//如果视见体是对称的(r = -l, t = -b)，还可以进一步简化矩阵</span>
P <span class="token operator">=</span> <span class="token punctuation">[</span>
 n<span class="token operator">/</span>r<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">/</span>t<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token punctuation">(</span>f<span class="token operator">+</span>n<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>f<span class="token operator">-</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2f</span>n<span class="token operator">/</span>f<span class="token operator">-</span>n<span class="token punctuation">,</span>
 <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span>
<span class="token punctuation">]</span></code></pre></div>
<p>推导过程还可参考：</p>
<p><a href="http://www.360doc.com/content/14/1028/10/19175681_420522154.shtml">http://www.360doc.com/content/14/1028/10/19175681_420522154.shtml</a></p>
<p><strong>视锥体裁剪（Frustum Culling）</strong></p>
<p>视锥体裁剪即在渲染前通过计算物体是否在视锥体内，从而决定该物体是否需要绘制的过程。</p>
<p>基本介绍和原理可参考下列文章：</p>
<p><a href="http://blog.hakugyokurou.net/?p=760">http://blog.hakugyokurou.net/?p=760</a></p>
<p><a href="http://gad.qq.com/program/translateview/7190998">http://gad.qq.com/program/translateview/7190998</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/66407205">https://zhuanlan.zhihu.com/p/66407205</a></p>
<p>具体实现采用边界球的方法：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> maxRadiusSq <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//遍历所有顶点获取到中心的最大距离（即边界球半径）</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    tempVec3<span class="token punctuation">.</span><span class="token function">fromArray</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    maxRadiusSq <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>maxRadiusSq<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>center<span class="token punctuation">.</span><span class="token function">squaredDistance</span><span class="token punctuation">(</span>tempVec3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>radius <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>maxRadiusSq<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>边界中心的计算方法：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> x <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> y <span class="token operator">=</span> array<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> z <span class="token operator">=</span> array<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    min<span class="token punctuation">.</span>x <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> min<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    min<span class="token punctuation">.</span>y <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> min<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    min<span class="token punctuation">.</span>z <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> min<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
    max<span class="token punctuation">.</span>x <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> max<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    max<span class="token punctuation">.</span>y <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> max<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    max<span class="token punctuation">.</span>z <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> max<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
scale<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>max<span class="token punctuation">,</span> min<span class="token punctuation">)</span><span class="token punctuation">;</span>
center<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>min<span class="token punctuation">,</span> max<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>最后Camera按照边界判断是否需要剔除：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token function">frustumIntersectsSphere</span><span class="token punctuation">(</span>center<span class="token punctuation">,</span> radius<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> normal <span class="token operator">=</span> tempVec3b<span class="token punctuation">;</span>
      <span class="token comment">//遍历视锥体的六个面</span>
      <span class="token comment">//若物体中心在视锥体六个面之后(&lt;-radius)，则不在视锥体内</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> plane <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>frustum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> distance <span class="token operator">=</span> normal<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>plane<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">dot</span><span class="token punctuation">(</span>center<span class="token punctuation">)</span> <span class="token operator">+</span> plane<span class="token punctuation">.</span>constant<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>distance <span class="token operator">&lt;</span> <span class="token operator">-</span>radius<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>六个面(Frustum planes)的计算方法：</p>
<p>计算原理可参考：</p>
<p><a href="https://www.cnblogs.com/mavaL/articles/1920553.html">https://www.cnblogs.com/mavaL/articles/1920553.html</a></p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token function">updateFrustum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>frustum<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>frustum <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Vec3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Vec3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Vec3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Vec3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Vec3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Vec3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> m <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>projectionViewMatrix<span class="token punctuation">;</span>
  <span class="token comment">//各平面方程</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>frustum<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> m<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constant <span class="token operator">=</span> m<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">-</span> m<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// -x</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>frustum<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constant <span class="token operator">=</span> m<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// +x</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>frustum<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constant <span class="token operator">=</span> m<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// +y</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>frustum<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> m<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constant <span class="token operator">=</span> m<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">-</span> m<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// -y</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>frustum<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> m<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">-</span> m<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constant <span class="token operator">=</span> m<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">-</span> m<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// +z (far)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>frustum<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constant <span class="token operator">=</span> m<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> m<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// -z (near)</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> invLen <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>frustum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">distance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>frustum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>invLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>frustum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>constant <span class="token operator">*=</span> invLen<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3>Renderer</h3>
<p>因为没有任何内置材质，这里Renderer只负责管理渲染队列及根据配置项初始化gl上下文。</p>
<p>优先获取WebGL2的gl绘图上下文，若不支持WebGL2.0则尝试加载相关<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Using_Extensions">扩展</a>：</p>
<ul>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/OES_texture_float">OES<em>texture</em>float</a>：纹素坐标支持浮点类型</p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/OES_texture_float_linear">OES<em>texture</em>float_linear</a>：纹理过滤支持浮点类型的线性过滤</p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/OES_texture_half_float">OES<em>texture</em>half_float</a>：纹素坐标支持16位（32/2）浮点类型数据</p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/OES_element_index_uint">OES<em>element</em>index_uint</a>：渲染图元(<code class="language-text">gl.drawElements</code>)的数据支持无符号整型</p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/OES_standard_derivatives">OES<em>standard</em>derivatives</a>：在GLSL中添加方法：<code class="language-text">dFdx</code>,<code class="language-text">dFdy</code>和<code class="language-text">fwidth</code></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/EXT_sRGB">EXT_sRGB</a>：纹理及帧缓存支持<a href="https://baike.baidu.com/item/sRGB/1350619?fr=aladdin">sRGB</a>颜色格式</p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WEBGL_depth_texture">WEBGL<em>depth</em>texture</a>：定义2D深度和深度模板纹理 //Todo</p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ANGLE_instanced_arrays">ANGLE<em>instanced</em>arrays</a>：使用实例化渲染绘制多个相似物体</p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/OES_vertex_array_object">OES<em>vertex</em>array_object</a>：支持VAO</p>
</li>
</ul>
<p><a href="http://johnnymao.com/2016/03/07/GC/">深度缓冲与画家算法</a></p>
<p>总而言之：画家算法是按照物体（多边形）的深度进行排序，而Z-buffer算法是按照图像每一个像素进行排序。</p>
<p>渲染队列绘制的顺序：</p>
<ul>
<li>
<p>1.先绘制所有不透明的物体。</p>
</li>
<li>
<p>2.对所有透明的物体排序。</p>
</li>
<li>
<p>3.按物体的z值排序绘制所有透明的物体。</p>
</li>
</ul>
<p>drawCall中再更新scene及camera的矩阵信息</p>
<h3>Program</h3>
<p>Program负责绑定并更新传入的uniform变量、创建及编译程序对象。</p>
<h3>Geometry</h3>
<p>Geometry负责绑定及更新传入的attribute变量、创建基本的几何对象、计算几何体的边界数据。</p>
<p>封装<a href="https://learnopengl-cn.github.io/01%20Getting%20started/04%20Hello%20Triangle/">索引缓冲对象（IBO）</a>及<a href="https://learnopengl-cn.github.io/04%20Advanced%20OpenGL/10%20Instancing/">实例化（Instancing）</a></p>
<p>使用实例化时直接按照attribute属性使用即可</p>
<h3>Texture</h3>
<p>Texture根据传入配置创建对应的材质对象。</p>
<p>对应参数可参考：<a href="https://learnopengl-cn.github.io/01%20Getting%20started/06%20Textures/">https://learnopengl-cn.github.io/01%20Getting%20started/06%20Textures/</a></p>
<h3>Mesh</h3>
<p>Mesh是对Program和Geometry添加的一层封装，每次drawCall时将Camera的矩阵数据同步至Program的uniform中，最后再调用Geometry的draw方法同步attribute变量并完成绘制。</p>
<h3>RenderTarget</h3>
<p>RenderTarget对<a href="https://learnopengl-cn.github.io/04%20Advanced%20OpenGL/05%20Framebuffers/">帧缓存对象(Framebuffers)</a> 的创建进行了封装</p>
<h2>Extras</h2>
<hr>
<h3>Orbit</h3>
<p>Orbit通过监听Web中的鼠标几个事件动态变化Camera的轨道位置：</p>
<p><strong>contextmenu</strong></p>
<p>直接屏蔽原生的右键点击事件：<code class="language-text">e.preventDefault();</code></p>
<p><strong>mousedown</strong></p>
<p>需要实现：</p>
<ul>
<li>
<p>左键点击按住控制旋转</p>
</li>
<li>
<p>中键点击按住控制推拉</p>
</li>
<li>
<p>右键点击按住控制位移</p>
</li>
</ul>
<p>在触发mousedown事件时记录鼠标此时的在屏幕中的位置（clientX/Y），并开始监听mousemove和mouseup事件，分别用于处理具体的相机轨道位置变化和结束后删除mousemove和mouseup的事件监听。</p>
<p>那最核心的计算是如何实现的呢？</p>
<p><a href="https://zh.wikipedia.org/wiki/%E7%90%83%E5%BA%A7%E6%A8%99%E7%B3%BB">球坐标系-wiki</a></p>
<p>假设P（x，y，z）为空间内一点，则点P也可用这样三个有次序的数(r，θ，φ)来确定，其中：</p>
<ul>
<li>
<p>r为原点O与点P间的距离（radius）</p>
</li>
<li>
<p>φ为有向线段OP与z轴正向的夹角（phi）</p>
</li>
<li>
<p>θ为从正z轴来看自x轴按逆时针方向转到OM所转过的角，M为点P在xOy面上的投影（theta）</p>
</li>
</ul>
<p><code class="language-text">Tips1：需要注意我们的世界坐标y轴是朝上的，而非百科里z轴是朝上的。</code></p>
<p><code class="language-text">Tips2：φ与θ的符号标记在数学中与物理中正好相反（可见wiki）</code></p>
<p>直角坐标系与球坐标系的转换即为(画个图加上基本的三角函数即可得)：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">radius <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x <span class="token operator">*</span> x <span class="token operator">+</span> y <span class="token operator">*</span> y <span class="token operator">+</span> z <span class="token operator">*</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>
theta <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">atan2</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>
phi <span class="token operator">=</span>  Math<span class="token punctuation">.</span><span class="token function">acos</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>y <span class="token operator">/</span> radius<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Tips: <a href="https://zh.wikipedia.org/wiki/Atan2">atan2</a></p>
<p>所以可以知道：</p>
<ul>
<li>
<p>X轴的旋转即为theta的变化</p>
</li>
<li>
<p>Y轴的旋转即为phi的变化</p>
</li>
<li>
<p>Z轴的推拉即为radius的变化</p>
</li>
</ul>
<p>具体的实现代码：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">/**
* Handle left click + mouse move event => 旋转

*/</span>

<span class="token function">handleMoveRotate</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    tempVec2a<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

    tempVec2b<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>tempVec2a<span class="token punctuation">,</span> rotateStart<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>rotateSpeed<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//计算变化向量</span>

    <span class="token keyword">let</span> el <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>element <span class="token operator">===</span> document <span class="token operator">?</span> document<span class="token punctuation">.</span>body <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>element<span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>sphericalDelta<span class="token punctuation">.</span>theta <span class="token operator">-=</span> <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> tempVec2b<span class="token punctuation">.</span>x <span class="token operator">/</span> el<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span> <span class="token comment">//换算成变换的弧度</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>sphericalDelta<span class="token punctuation">.</span>phi <span class="token operator">-=</span> <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> tempVec2b<span class="token punctuation">.</span>y <span class="token operator">/</span> el<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>

    rotateStart<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>tempVec2a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//重置变换点</span>

<span class="token punctuation">}</span>


<span class="token comment">/**

* Handle midlle click + mouse move event => 推拉

*/</span>

<span class="token function">handleMouseMoveDolly</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    tempVec2a<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span> e<span class="token punctuation">.</span>clientY<span class="token punctuation">)</span><span class="token punctuation">;</span>

    tempVec2b<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>tempVec2a<span class="token punctuation">,</span> dollyStart<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>tempVec2b<span class="token punctuation">.</span>y <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Up scroll</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dolly</span><span class="token punctuation">(</span><span class="token function">getZoomScale</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>zoomSpeed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>tempVec2b<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Dwon scroll</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dolly</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token function">getZoomScale</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>zoomSpeed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    dollyStart<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>tempVec2a<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token function">dolly</span><span class="token punctuation">(</span>dollyScale<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sphericalDelta<span class="token punctuation">.</span>radius <span class="token operator">/=</span> dollyScale<span class="token punctuation">;</span> <span class="token comment">//变换radius</span>

<span class="token punctuation">}</span></code></pre></div>
<p><strong>wheel</strong></p>
<p>中键的滚轮控制放大/缩小也就是变化radius，只不过添加了一个速度因子</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">/**
* Handle mourse wheel event

*/</span>

<span class="token function">onMouseWheel</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span> enabled<span class="token punctuation">,</span> enableZoom<span class="token punctuation">,</span> state <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>enabled <span class="token operator">||</span> <span class="token operator">!</span>enableZoom <span class="token operator">||</span> <span class="token punctuation">(</span>state <span class="token operator">!==</span> <span class="token constant">STATE</span><span class="token punctuation">.</span><span class="token constant">NONE</span> <span class="token operator">&amp;&amp;</span> state <span class="token operator">!==</span> <span class="token constant">STATE</span><span class="token punctuation">.</span><span class="token constant">ROTATE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>deltaY <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dolly</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token function">getZoomScale</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>zoomSpeed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>deltaY <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dolly</span><span class="token punctuation">(</span><span class="token function">getZoomScale</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>zoomSpeed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre></div>
<p>唯一不同的是右键的位移效果：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">/**
* Handle right click + mouse move event

*/</span>

<span class="token function">handleMovePan</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    tempVec2a<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

    tempVec2b<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>tempVec2a<span class="token punctuation">,</span> panStart<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>panSpeed<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//计算变化向量</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pan</span><span class="token punctuation">(</span>tempVec2b<span class="token punctuation">.</span>x<span class="token punctuation">,</span> tempVec2b<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

    panStart<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>tempVec2a<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token function">pan</span><span class="token punctuation">(</span>deltaX<span class="token punctuation">,</span> deltaY<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> <span class="token punctuation">{</span> element<span class="token punctuation">,</span> camera <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> el <span class="token operator">=</span> element <span class="token operator">===</span> document <span class="token operator">?</span> document<span class="token punctuation">.</span>body <span class="token punctuation">:</span> element<span class="token punctuation">;</span>
    <span class="token comment">// perspective</span>

    tempVec3<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>camera<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> targetDistance <span class="token operator">=</span> tempVec3<span class="token punctuation">.</span><span class="token function">distance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// half of the fov is center to top of screen</span>

    targetDistance <span class="token operator">*=</span> Math<span class="token punctuation">.</span><span class="token function">tan</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>camera<span class="token punctuation">.</span>fov <span class="token operator">||</span> <span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">180.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//投影高度</span>

    <span class="token comment">// we use only clientHeight here so aspect ratio does not distort speed</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">panLeft</span><span class="token punctuation">(</span>deltaX <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> targetDistance <span class="token operator">/</span> el<span class="token punctuation">.</span>clientHeight<span class="token punctuation">,</span> camera<span class="token punctuation">.</span>matrix<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//高度比值</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">panUp</span><span class="token punctuation">(</span>deltaY <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> targetDistance <span class="token operator">/</span> el<span class="token punctuation">.</span>clientHeight<span class="token punctuation">,</span> camera<span class="token punctuation">.</span>matrix<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">panLeft</span><span class="token punctuation">(</span>distance<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    tempVec3<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//X</span>

    tempVec3<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token operator">-</span>distance<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>panDelta<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tempVec3<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token function">panUp</span><span class="token punctuation">(</span>distance<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    tempVec3<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Y</span>

    tempVec3<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>distance<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>panDelta<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tempVec3<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span></code></pre></div>
<p>移动端对<code class="language-text">touchstart/touchend/touchmove</code>事件的处理方法也是同理，就不再赘述了。</p>
<h3>Base Primitives</h3>
<p><strong>Plane</strong></p>
<p>根据传入参数决定面几何体横向与纵向组成块数，然后计算顶点的position、normal、uv、index信息：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">static</span> <span class="token function">buildPlane</span><span class="token punctuation">(</span>position<span class="token punctuation">,</span> normal<span class="token punctuation">,</span> uv<span class="token punctuation">,</span> index<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> depth <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> wSegs<span class="token punctuation">,</span> hSegs<span class="token punctuation">,</span>

        u <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> v <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> w <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
        uDir <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> vDir <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
        i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> ii <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> io <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token keyword">const</span> segW <span class="token operator">=</span> width <span class="token operator">/</span> wSegs<span class="token punctuation">;</span>
        <span class="token keyword">const</span> segH <span class="token operator">=</span> height <span class="token operator">/</span> hSegs<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> iy <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> iy <span class="token operator">&lt;=</span> hSegs<span class="token punctuation">;</span> iy<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> y <span class="token operator">=</span> iy <span class="token operator">*</span> segH <span class="token operator">-</span> height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//y = [-h/2,h/2]</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> ix <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ix <span class="token operator">&lt;=</span> wSegs<span class="token punctuation">;</span> ix<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> x <span class="token operator">=</span> ix <span class="token operator">*</span> segW <span class="token operator">-</span> width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//x = [-w/2,w/2]</span>

                position<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> u<span class="token punctuation">]</span> <span class="token operator">=</span> x <span class="token operator">*</span> uDir<span class="token punctuation">;</span>
                position<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> v<span class="token punctuation">]</span> <span class="token operator">=</span> y <span class="token operator">*</span> vDir<span class="token punctuation">;</span> <span class="token comment">// eg:leftTopfirPos = [-w/2,h/2]</span>
                position<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> w<span class="token punctuation">]</span> <span class="token operator">=</span> depth <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

                normal<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                normal<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> v<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                normal<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> w<span class="token punctuation">]</span> <span class="token operator">=</span> depth <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

                uv<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> ix <span class="token operator">/</span> wSegs<span class="token punctuation">;</span>
                uv<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> iy <span class="token operator">/</span> hSegs<span class="token punctuation">;</span>

                i<span class="token operator">++</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>iy <span class="token operator">===</span> hSegs <span class="token operator">||</span> ix <span class="token operator">===</span> wSegs<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>

                <span class="token comment">//indices(two triangle)</span>
                <span class="token keyword">let</span> indicesWSegs <span class="token operator">=</span> <span class="token punctuation">(</span>wSegs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">let</span> a <span class="token operator">=</span> io <span class="token operator">+</span> ix <span class="token operator">+</span> iy <span class="token operator">*</span> indicesWSegs<span class="token punctuation">;</span> <span class="token comment">//iy * indicesWSegs => a rows</span>
                <span class="token keyword">let</span> b <span class="token operator">=</span> io <span class="token operator">+</span> ix <span class="token operator">+</span> <span class="token punctuation">(</span>iy <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> indicesWSegs<span class="token punctuation">;</span>
                <span class="token keyword">let</span> c <span class="token operator">=</span> io <span class="token operator">+</span> <span class="token punctuation">(</span>ix <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>iy <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> indicesWSegs<span class="token punctuation">;</span>
                <span class="token keyword">let</span> d <span class="token operator">=</span> io <span class="token operator">+</span> <span class="token punctuation">(</span>ix <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> iy <span class="token operator">*</span> indicesWSegs<span class="token punctuation">;</span>

                index<span class="token punctuation">[</span>ii <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">;</span>
                index<span class="token punctuation">[</span>ii <span class="token operator">*</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
                index<span class="token punctuation">[</span>ii <span class="token operator">*</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">;</span>

                index<span class="token punctuation">[</span>ii <span class="token operator">*</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
                index<span class="token punctuation">[</span>ii <span class="token operator">*</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
                index<span class="token punctuation">[</span>ii <span class="token operator">*</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">;</span>

                ii<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre></div>
<p><strong>Cube</strong></p>
<p>Cube则是直接拼合六块Plane即可：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"> <span class="token comment">// left, right</span>
 Plane<span class="token punctuation">.</span><span class="token function">buildPlane</span><span class="token punctuation">(</span>position<span class="token punctuation">,</span> normal<span class="token punctuation">,</span> uv<span class="token punctuation">,</span> index<span class="token punctuation">,</span> depth<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">,</span> dSegs<span class="token punctuation">,</span> hSegs<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> ii<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ZYX</span>

Plane<span class="token punctuation">.</span><span class="token function">buildPlane</span><span class="token punctuation">(</span>position<span class="token punctuation">,</span> normal<span class="token punctuation">,</span> uv<span class="token punctuation">,</span> index<span class="token punctuation">,</span> depth<span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token operator">-</span>width<span class="token punctuation">,</span> dSegs<span class="token punctuation">,</span> hSegs<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> i <span class="token operator">+=</span> <span class="token punctuation">(</span>dSegs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>hSegs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ii <span class="token operator">+=</span> dSegs <span class="token operator">*</span> hSegs<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// top, bottom</span>

Plane<span class="token punctuation">.</span><span class="token function">buildPlane</span><span class="token punctuation">(</span>position<span class="token punctuation">,</span> normal<span class="token punctuation">,</span> uv<span class="token punctuation">,</span> index<span class="token punctuation">,</span> width<span class="token punctuation">,</span> depth<span class="token punctuation">,</span> height<span class="token punctuation">,</span> dSegs<span class="token punctuation">,</span> hSegs<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> i <span class="token operator">+=</span> <span class="token punctuation">(</span>dSegs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>hSegs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ii <span class="token operator">+=</span> dSegs <span class="token operator">*</span> hSegs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//XZY</span>

Plane<span class="token punctuation">.</span><span class="token function">buildPlane</span><span class="token punctuation">(</span>position<span class="token punctuation">,</span> normal<span class="token punctuation">,</span> uv<span class="token punctuation">,</span> index<span class="token punctuation">,</span> width<span class="token punctuation">,</span> depth<span class="token punctuation">,</span> <span class="token operator">-</span>height<span class="token punctuation">,</span> dSegs<span class="token punctuation">,</span> hSegs<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> i <span class="token operator">+=</span> <span class="token punctuation">(</span>wSegs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>dSegs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ii <span class="token operator">+=</span> wSegs <span class="token operator">*</span> dSegs<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// front, back</span>

Plane<span class="token punctuation">.</span><span class="token function">buildPlane</span><span class="token punctuation">(</span>position<span class="token punctuation">,</span> normal<span class="token punctuation">,</span> uv<span class="token punctuation">,</span> index<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token operator">-</span>depth<span class="token punctuation">,</span> wSegs<span class="token punctuation">,</span> hSegs<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> i <span class="token operator">+=</span> <span class="token punctuation">(</span>wSegs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>dSegs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ii <span class="token operator">+=</span> wSegs <span class="token operator">*</span> dSegs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//XYZ</span>

Plane<span class="token punctuation">.</span><span class="token function">buildPlane</span><span class="token punctuation">(</span>position<span class="token punctuation">,</span> normal<span class="token punctuation">,</span> uv<span class="token punctuation">,</span> index<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> depth<span class="token punctuation">,</span> wSegs<span class="token punctuation">,</span> hSegs<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> i <span class="token operator">+=</span> <span class="token punctuation">(</span>wSegs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>hSegs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ii <span class="token operator">+=</span> wSegs <span class="token operator">*</span> hSegs<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>Sphere</strong></p>
<p>Sphere根据φ（phi）与θ（theta）的数值及横向与纵向组成块数计算坐标：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">//画个图+三角函数</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token operator">-</span>radius <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>tStart <span class="token operator">+</span> v <span class="token operator">*</span> tLength<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>pStart <span class="token operator">+</span> u <span class="token operator">*</span> pLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> radius <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>tStart <span class="token operator">+</span> v <span class="token operator">*</span> tLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> z <span class="token operator">=</span> radius <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>tStart <span class="token operator">+</span> v <span class="token operator">*</span> tLength<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>pStart <span class="token operator">+</span> u <span class="token operator">*</span> pLength<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>ToAdd:</p>
<ul>
<li class="task-list-item">
<p><input type="checkbox" disabled> Text：字体渲染的方法</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" checked disabled> Post：后期处理</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" checked disabled> glTFLoader：这个单拆一篇文章</p>
</li>
</ul></div><div class="jsx-3827537667"><div id="backToTop" class="jsx-3827537667"></div><div class="jsx-3827537667 gotop "><img src="/LG-Blog-Gatsby/static/recive-9df7de779021f757d61dad14241a3686.png" width="100px" class="jsx-3827537667"/></div></div><footer><div class="jsx-126278577 links"><a href="/LG-Blog-Gatsby/video-alpha/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em"><path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"></path></svg><h4 class="jsx-126278577">Web动效通用实现方案探究<!-- --> <time class="jsx-126278577">2019-04-28<!-- --> </time></h4></a><a href="/LG-Blog-Gatsby/miku-setup/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em"><path d="M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"></path></svg><h4 class="jsx-126278577">MikuMikuMi<!-- --> <time class="jsx-126278577">2018-08-31</time></h4></a></div></footer></article></main><footer class="jsx-2344609357 footer"><ul>
<li>© todaylg 2018</li>
<li>build base on <a href="https://www.gatsbyjs.org/">gatsby</a> and <a href="https://github.com/greglobinski/gatsby-starter-hero-blog">hero-starter</a></li>
</ul></footer></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'undefined', 'auto', {});
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-post-template-js","jsonName":"lgl-143","path":"/lgl/"};window.dataPath="887/path---lgl-143-594-R1pWcLuFpkaMpwUVW6Az9zvKP6g";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app.114d644fbd0f178a7b99.css","/app-bab684d8b8f29b3f4d28.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-ef9160364eaafc77296f.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-69e304dab4c53293a622.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js.e00996c3b58f2f9b9719.css","/component---src-templates-post-template-js-8e85dd8dc3a92e7303c1.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-2ccd560dedf3b49e24e9.js"],"component---src-pages-404-js":["/component---src-pages-404-js-61159dbda7c550a771b9.js"],"component---src-pages-category-js":["/component---src-pages-category-js-9fce64549a9d43605363.js"],"component---src-pages-contact-js":["/component---src-pages-contact-js-acaeb16c5709a696aef1.js"],"component---src-pages-index-js":["/component---src-pages-index-js-5f439d23aa34c984adb7.js"],"component---src-pages-search-js":["/component---src-pages-search-js-fe9e20cb240b3edea409.js"]};/*]]>*/</script><script src="/LG-Blog-Gatsby/webpack-runtime-ee5c99529da3fc26e898.js" async=""></script><script src="/LG-Blog-Gatsby/app-bab684d8b8f29b3f4d28.js" async=""></script><script src="/LG-Blog-Gatsby/component---src-templates-post-template-js-8e85dd8dc3a92e7303c1.js" async=""></script><script src="/LG-Blog-Gatsby/0-c0983f293ccd2b817b46.js" async=""></script></body></html>