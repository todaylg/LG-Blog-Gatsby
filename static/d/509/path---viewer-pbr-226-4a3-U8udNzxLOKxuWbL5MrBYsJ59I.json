{"data":{"post":{"id":"3bdfb94d-b75b-588b-a90a-f3b10547e308","html":"<p>åœ¨é€šè¿‡Envtoolså°†é¢„è®¡ç®—çš„èµ„æºè¿›è¡Œæ‰“åŒ…åï¼Œè‡ªç„¶å°±éœ€è¦åœ¨Viewerè¿›è¡Œè§£åŒ…å’Œæ¸²æŸ“å•¦:</p>\n<p><a href=\"https://github.com/todaylg/three-viewer\">https://github.com/todaylg/three-viewer</a></p>\n<p>æ­ªå‡ºæ¥æ„Ÿå¹ä¸€å¥ï¼Œæ‚å®ŒViewerä»¥åç…§å¸¸å‘äº†ä¸ªTwitterçºªå¿µï¼Œä½†æ˜¯æ²¡æƒ³åˆ°å¾—åˆ°äº†Threejså®˜æ¨çš„è½¬æ¨ä»¥åŠMr.doobå¤§ç¥çš„ç‚¹èµï¼Œå¼€å¿ƒäº†å¥½ä¸€ä¼šå“ˆå“ˆ<del>å¿«ä¹å¦‚æ­¤ç®€å•</del></p>\n<div style=\"text-align: center\">  \n<img style=\"width:100%;\" src=\"https://raw.githubusercontent.com/todaylg/LG-Blog-Gatsby/master/content/posts/2020-3-19--viewer-pbr/twitter.png\">  \n</div>\n<p>å›åˆ°æ­£é¢˜ï¼Œé¦–å…ˆéœ€è¦Viewerå®Œæˆçš„æ˜¯IBLéƒ¨åˆ†çš„å…‰ç…§ï¼Œä¹‹å‰åœ¨EnvToolsæ‰“åŒ…å¥½çš„èµ„æºå°±æ´¾ä¸Šç”¨åœºå•¦ï¼Œä¸»è¦çš„è§£åŒ…æµç¨‹å¯ä»¥ç›´æ¥å‚è€ƒosg.jsçš„å®ç°ï¼Œè§£å®ŒåŒ…ä»¥åå¯ä»¥å¾—åˆ°ï¼š</p>\n<ul>\n<li>SH coefficients</li>\n<li>Prefiltered Mipmap CubeMap</li>\n<li>Blur Background CubeMap</li>\n<li>BRDF LUT</li>\n<li>Sunlight</li>\n</ul>\n<p>åŸºäºè¿™äº›èµ„æºä¾¿å¯ä»¥æ‹Ÿåˆç¯å¢ƒå…‰ç…§çš„æ•ˆæœå•¦</p>\n<h2>ç¯å¢ƒå…‰ç…§</h2>\n<h3>IBL</h3>\n<p>IBLä¹Ÿæ˜¯åˆ†ä¸ºDiffuseéƒ¨åˆ†å’ŒSpecularéƒ¨åˆ†ã€‚</p>\n<p>Diffuseéƒ¨åˆ†å¯ä»¥ç›´æ¥é€šè¿‡SH coefficientsè®¡ç®—ï¼Œç›¸å…³æ–‡ç« ï¼š</p>\n<ul>\n<li>\n<p><a href=\"https://cseweb.ucsd.edu/~ravir/papers/envmap/envmap.pdf\">https://cseweb.ucsd.edu/~ravir/papers/envmap/envmap.pdf</a></p>\n</li>\n<li>\n<p><a href=\"https://zhuanlan.zhihu.com/p/63755519\">https://zhuanlan.zhihu.com/p/63755519</a></p>\n</li>\n</ul>\n<p>Specularéƒ¨åˆ†åˆ™æ˜¯æ ¹æ®ä¸åŒç²—ç³™åº¦å¯¹ä¸åŒçº§åˆ«Mipmapçš„é¢„è®¡ç®—CubeMapè¿›è¡Œé‡‡æ ·ï¼Œå†è¿›è¡ŒBRDFçš„è®¡ç®—ï¼Œç›¸å…³æ–‡ç« ï¼š</p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/66518450\">https://zhuanlan.zhihu.com/p/66518450</a></p>\n<p>æ‰‹æœºç«¯å‡ºäºæ€§èƒ½åŸå› éœ€è¦ç”¨è¿‡æ‹Ÿåˆå‡½æ•°ä»£æ›¿LUTé‡‡æ ·ï¼Œç›¸å…³æ–‡ç« ï¼š</p>\n<ul>\n<li><a href=\"https://www.unrealengine.com/blog/physically-based-shading-on-mobile\">https://www.unrealengine.com/blog/physically-based-shading-on-mobile</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/68158277\">https://zhuanlan.zhihu.com/p/68158277</a></li>\n</ul>\n<h3>Background</h3>\n<p>ç›´æ¥ä½¿ç”¨ä¸€ä¸ªå¤§çš„SphereåŒ…è£¹åœºæ™¯ï¼Œç„¶ååœ¨èƒŒé¢é‡‡æ ·Background CubeMapï¼Œæœ€åå†é€šè¿‡çŸ©é˜µåŒæ­¥ä¸€ä¸‹ç›¸æœºçš„è¿åŠ¨æ–¹å‘å³å¯ã€‚</p>\n<h3>Sunlight</h3>\n<p>é€šè¿‡Envtoolså¯ä»¥æ‹¿åˆ°ç¯å¢ƒè´´å›¾ä¸­æœ€äº®åŒºåŸŸçš„æ–¹å‘ï¼Œåœ¨åœºæ™¯åŒä¸€æ–¹å‘æ·»åŠ ä¸€ç›æ–¹å‘å…‰å³å¯æ¨¡æ‹Ÿå¤ªé˜³</p>\n<h3>Env Rotation</h3>\n<p>ä¸ºäº†åŒæ­¥è§†è§‰æ•ˆæœï¼Œç¯å¢ƒå…‰çš„æ—‹è½¬ä¸ä»…å½±å“åˆ°IBLçš„è®¡ç®—ï¼ŒBackgroundå’ŒSunlightä¹Ÿéœ€è¦åŒæ­¥æ—‹è½¬ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">syncEnvTransform</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>invCameraQuaternion<span class=\"token punctuation\">.</span><span class=\"token function\">copy</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>camera<span class=\"token punctuation\">.</span>quaternion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">conjugate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cameraRotationMatrix<span class=\"token punctuation\">.</span><span class=\"token function\">makeRotationFromQuaternion</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>invCameraQuaternion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>oringinCameraMatrix<span class=\"token punctuation\">.</span><span class=\"token function\">extractRotation</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>camera<span class=\"token punctuation\">.</span>matrixWorld<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">updateEnvironmentRotation</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// Add panel rotation</span>\n\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>envRotationFromPanel<span class=\"token punctuation\">.</span><span class=\"token function\">makeRotationY</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>envRotationMat<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">multiplyMatrices</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cameraRotationMatrix<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>envRotationFromPanel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// Direction compute by position</span>\n\t<span class=\"token keyword\">let</span> resultSunlight <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sunLightStartPos<span class=\"token punctuation\">.</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tresultSunlight<span class=\"token punctuation\">.</span><span class=\"token function\">applyMatrix4</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>envRotationMat<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">applyMatrix4</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>oringinCameraMatrix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sunLight<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">.</span><span class=\"token function\">copy</span><span class=\"token punctuation\">(</span>resultSunlight<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ç›¸å…³æ–‡ç« ï¼š</p>\n<ul>\n<li><a href=\"https://zhuanlan.zhihu.com/p/50699527\">https://zhuanlan.zhihu.com/p/50699527</a></li>\n</ul>\n<h2>ç›´æ¥å…‰ç…§</h2>\n<p>å…‰å…‰æœ‰ç¯å¢ƒå…‰ç…§æ˜¯ä¸å¤Ÿçš„ï¼Œæƒ³è¦åœ¨åœºæ™¯ä¸­æ·»åŠ çš„ç›´æ¥å…‰æºæœ‰æ•ˆæœï¼ˆæ¯”å¦‚å‰é¢ä¸ºäº†æ¨¡æ‹Ÿæ—¥å…‰æ·»åŠ æ–¹å‘å…‰ï¼‰ï¼Œå°±è¿˜éœ€è¦å†å®ç°ç›´æ¥å…‰ç…§çš„éƒ¨åˆ†ã€‚</p>\n<p>ç›´æ¥å…‰ç…§ä¹ŸåŒæ ·è¿˜æ˜¯åˆ†ä¸ºDiffuseéƒ¨åˆ†å’ŒSpecularéƒ¨åˆ†ã€‚å„éƒ¨åˆ†ä¸åŒçš„æ¸²æŸ“æ–¹ç¨‹æœ‰å¾ˆå¤šç§ï¼Œä¸ºäº†ä¾¿äºæ¯”å¯¹ä¸åŒæ–¹ç¨‹çš„ä¸åŒæ¸²æŸ“æ•ˆæœï¼Œæœ€åæ˜¯å°†æ–¹ç¨‹å¼„æˆäº†å¯é€‰åˆ—è¡¨æ”¾åœ¨äº†Viewerä¸­ï¼ˆç›´æ¥æŠŠUE4 BRDFä¸­çš„å…¬å¼å…¨æ¬äº†è¿‡æ¥ğŸ˜‚ï¼ŒUnrealå¼ºæ— æ•Œï¼‰ã€‚</p>\n<p>Diffuseéƒ¨åˆ†çš„æ¸²æŸ“æ–¹ç¨‹ï¼š</p>\n<ul>\n<li>Lambert</li>\n<li>Burleyï¼š[Burley 2012, â€œPhysically-Based Shading at Disneyâ€]</li>\n<li>OrenNayarï¼š[Gotanda 2012, â€œBeyond a Simple Physically Based Blinn-Phong Model in Real-Timeâ€]</li>\n<li>Gotandaï¼š[Gotanda 2014, â€œDesigning Reflectance Models for New Consolesâ€]</li>\n</ul>\n<p>ç›¸å…³æ–‡ç« ï¼š</p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/53086060\">https://zhuanlan.zhihu.com/p/53086060</a></p>\n<p>Specularéƒ¨åˆ†è¿˜æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„Cook-Torrance BRDF</p>\n<p>Normal Distribution Functions(NDF)æ–¹ç¨‹ï¼š</p>\n<ul>\n<li>Blinnï¼š[Blinn 1977, â€œModels of light reflection for computer synthesized picturesâ€]</li>\n<li>Beckmannï¼š[Beckmann 1963, â€œThe scattering of electromagnetic waves from rough surfacesâ€]</li>\n<li>GGX / Trowbridge-Reitzï¼š[Walter et al. 2007, â€œMicrofacet models for refraction through rough surfacesâ€]</li>\n</ul>\n<p>ç›¸å…³æ–‡ç« ï¼š</p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/69380665\">https://zhuanlan.zhihu.com/p/69380665</a></p>\n<p>Fresnelæ–¹ç¨‹ï¼š</p>\n<ul>\n<li>Schlickï¼š[Schlick 1994, â€œAn Inexpensive BRDF Model for Physically-Based Renderingâ€]</li>\n<li>CookTorranceï¼š[Cook-Torrance 1982]</li>\n</ul>\n<p>ç›¸å…³æ–‡ç« ï¼š</p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/53086060\">https://zhuanlan.zhihu.com/p/53086060</a></p>\n<p>Visibility Termæ–¹ç¨‹ï¼š</p>\n<ul>\n<li>Implicit</li>\n<li>Neumannï¼š[Neumann et al. 1999, â€œCompact metallic reflectance modelsâ€]</li>\n<li>Kelemenï¼š[Kelemen 2001, â€œA microfacet based coupled specular-matte brdf model with importance samplingâ€]</li>\n<li>Schlickï¼š[Schlick 1994, â€œAn Inexpensive BRDF Model for Physically-Based Renderingâ€]</li>\n<li>Smithï¼š[Smith 1967, â€œGeometrical shadowing of a random rough surfaceâ€]</li>\n<li>SmithJointApproxï¼š[Heitz 2014, â€œUnderstanding the Masking-Shadowing Function in Microfacet-Based BRDFsâ€]</li>\n</ul>\n<p>ç›¸å…³æ–‡ç« ï¼š</p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/81708753\">https://zhuanlan.zhihu.com/p/81708753</a></p>\n<p>å…¶å®ä½œä¸ºå·¥ç¨‹å…šï¼Œåªéœ€è¦å¤§æ¦‚çŸ¥é“æœ‰è¿™ä¹ˆäº›å…¬å¼å°±æ‹‰å€’äº†ï¼Œå¼ºæ’¸Paperå¿…å®šä¼šå¯¼è‡´ç§ƒé¡¶çš„æƒ¨å‰§ã€‚</p>\n<p>æ‰€ä»¥æˆ‘è§‰å¾—æœ€åˆç†çš„æµç¨‹åº”è¯¥æ˜¯è¿™æ ·çš„ï¼šå…ˆç­‰ç€ç®—æ³•å¤§ä½¬å¯¹å…¬å¼è¿›è¡Œåˆ†ææ€»ç»“ï¼Œå†ç­‰Unrealå¯¹å…¬å¼è¿›è¡Œå®è·µåŠä¼˜åŒ–ï¼Œæœ€åæ¡ç°æˆçš„ï¼Œç›´æ¥å»ç¿»Unrealçš„æºç æŠŠå‡½æ•°æ‰’å‡ºæ¥ç”¨å³å¯ï¼Œè¿™æ ·å¤´å‘åˆä¸ç”¨æ‰ï¼Œæ•ˆæœè¿˜å¥½ï¼Œç®€ç›´ä¹ƒç¥ç­–ä¹Ÿã€‚</p>\n<p>å…¶å®è€ƒè™‘åˆ°æ•ˆæœåŠåç»­æ‰©å±•(æ¯”å¦‚å„é¡¹å¼‚æ€§æè´¨)ï¼Œæ¸²æŸ“æ–¹ç¨‹åŸºæœ¬éƒ½æ˜¯ï¼š</p>\n<p>Diffuse: Lambert</p>\n<p>Specular: D<em>GGX * Vis</em>SmithJointApprox * F_Schlick</p>\n<p>æœ€åå†æ”¾å‡ å¼ æ¸²æŸ“æ•ˆæœ(å¯çˆ±çš„çŸ­å‘å¡å°”è¾¾ï¼)ï¼š</p>\n<div style=\"text-align: center\">  \n<img style=\"width:100%;\" src=\"https://raw.githubusercontent.com/todaylg/LG-Blog-Gatsby/master/content/posts/2020-3-19--viewer-pbr/zelda.png\">  \n</div>\n<p>MMMMMMaster Sword!!ï¼</p>\n<div style=\"text-align: center\">  \n<img style=\"width:100%;\" src=\"https://raw.githubusercontent.com/todaylg/LG-Blog-Gatsby/master/content/posts/2020-3-19--viewer-pbr/masterSword.png\">  \n</div>\n<div style=\"text-align: center\">  \n<img style=\"width:100%;\" src=\"https://raw.githubusercontent.com/todaylg/LG-Blog-Gatsby/master/content/posts/2020-3-19--viewer-pbr/bg.png\">  \n</div>\n<p>åœ¨çº¿ä½“éªŒåœ°å€ ï¼š<a href=\"https://todaylg.com/three-viewer/\">https://todaylg.com/three-viewer/</a></p>\n<h3>Todo</h3>\n<ul>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" disabled> Anisotropy(GGX)</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" disabled> Clearcoat</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" disabled> Sheen</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" disabled> Specular gloss</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" disabled> MorphTarget/Skin Animation</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" disabled> Post-processing(SSSã€TAA)</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" disabled> Ground Shadow</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" disabled> Shadow Jitter</p>\n</li>\n</ul>\n<p>å…¶å®Todo Listæ¸æ¸å˜æˆäº†Undo Listï¼ˆé€ƒã€‚ã€‚ã€‚ï¼‰</p>","fields":{"slug":"/viewer-pbr/","prefix":"2020-3-19"},"frontmatter":{"title":"Viewerä¸PBR","author":"todaylg","category":"å¤§ç»“","cover":{"childImageSharp":{"resize":{"src":"/static/bg-e18a1938fddf5546eca7f000bd48188a-160fa.png"}}}}},"authornote":{"id":"20cdfd79-00b3-57fb-a29f-bb96dcd133a8","html":"<p><strong>todaylg</strong> </p>"},"site":{"siteMetadata":{"facebook":{"appId":""}}}},"pageContext":{"slug":"/viewer-pbr/","prev":{"id":"463189d9-57f4-5739-803a-bcea665bda89","fields":{"slug":"/envtools/","prefix":"2020-3-03","source":"posts"},"frontmatter":{"title":"EnvTools","category":"å¤§ç»“"}},"source":"posts"}}