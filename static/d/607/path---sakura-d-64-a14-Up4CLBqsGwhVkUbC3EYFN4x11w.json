{"data":{"post":{"id":"c24dff1f-f104-56a5-85a8-57282c741b8a","html":"<p>平常在动漫里其实可以非常高频的看到各种伴随樱花的场景，而这些场景又都美得一批，每每看到这些场景让人都不由自主的连连称奇、拍案叫绝、惊为天人、振聋发聩、大呼过瘾</p>\n<p>从此对Sakura怀上了深深的执念。</p>\n<p>其实有许多大牛前辈早已在Web中进行了实现：</p>\n<p><strong>Canvas2D实现：</strong></p>\n<p>比如路人女主的<a href=\"https://www.saenai.tv/\">官网</a>在第二季还未开播的时候，网站的入场就使用的是大量樱花飘过的场景(可惜如今的官网已经改版掉了)，类似现在官网上这个<a href=\"https://www.saenai.tv/misakiten/\">页面</a>的效果(基于<a href=\"https://github.com/VincentGarreau/particles.js\">particles.js</a>)，实现的原理其实就是若干张樱花图片作为素材(ctx.drawImage)+位移计算。</p>\n<p>可惜这个解决方案在效果和性能上都差强人意。</p>\n<p><strong>WebGL实现：</strong></p>\n<p>WebGL实现则有以下几种方案：</p>\n<p><strong>Sprite</strong></p>\n<p>Sprite其实就是一块始终面向镜头的Plane，将图片素材作为贴图即可。</p>\n<p><strong>建模</strong></p>\n<p>给樱花建立一个简单的模型，比如<a href=\"https://yiwenl.github.io/Sketches/exps/32\">这个页面</a></p>\n<p>模型配合Instance其实也能获得不错的效果和性能：<a href=\"http://todaylg.com/LGL/examples/?src=instance.html\">LGL-instance</a></p>\n<p><strong>Particle</strong></p>\n<p>绘制图元时以<strong>gl.POINT</strong>直接进行绘制，将图片素材作为贴图即可。</p>\n<p>或者是不依赖任何素材，直接自己用Shader画，比如CodePen上的<a href=\"https://codepen.io/FrankFitzGerald/pen/LAbfm\">Sakura Animation using WebGL</a></p>\n<p>俗话说得好：画画和建模是不可能的，只有白嫖别人的效果，改扒改扒，才能勉强维持生活这样子。</p>\n<p>所以就是你了！<a href=\"https://codepen.io/FrankFitzGerald/pen/LAbfm\">CodePen</a>！！</p>\n<p>当然作为一名秉持着“白嫖也要知其所以然”学术精神的白学家，我们自然要象征性的分析一下这个效果是咋搞的：</p>\n<h2>Shape</h2>\n<p>前面也提到了这是一个纯WebGL效果，没有使用素材图片，所以首先最基础的一步自然是Sakura的形状绘制。</p>\n<p>直接通过片元着色器绘制一些图案其实并不罕见，比如：<a href=\"https://www.shadertoy.com/\">shadertoy</a>、<a href=\"http://glslsandbox.com/\">glslsandbox</a></p>\n<p>所以我们哗啦一下就画出一个椭圆了！</p>\n<iframe height=\"300\" style=\"width: 100%;\" scrolling=\"no\" title=\"Threejs-Sakura-Step1:Ellipse\" src=\"https://codepen.io/todaylg/embed/NWWBdgj?height=300&theme-id=default&default-tab=js,result\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\">\n  See the Pen <a href='https://codepen.io/todaylg/pen/NWWBdgj'>Threejs-Sakura-Step1:Ellipse</a> by todaylg\n  (<a href='https://codepen.io/todaylg'>@todaylg</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<p>旋转一些角度并且通过透明度裁剪一下哗啦就可以画出基本形状了！</p>\n<iframe height=\"300\" style=\"width: 100%;\" scrolling=\"no\" title=\"Threejs-Sakura-Step2:Sakura Shape\" src=\"https://codepen.io/todaylg/embed/yLLxweg?height=300&theme-id=default&default-tab=js,result\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\">\n  See the Pen <a href='https://codepen.io/todaylg/pen/yLLxweg'>Threejs-Sakura-Step2:Sakura Shape</a> by todaylg\n  (<a href='https://codepen.io/todaylg'>@todaylg</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<h2>Vertex Animation</h2>\n<p>2D扩展到3D，添加上各个轴向的一些随机旋转，哗啦一下就旋转起来了！</p>\n<iframe height=\"300\" style=\"width: 100%;\" scrolling=\"no\" title=\"Threejs-Sakura-Step3:Vertex Animation\" src=\"https://codepen.io/todaylg/embed/OJJoYxa?height=300&theme-id=default&default-tab=js,result\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\">\n  See the Pen <a href='https://codepen.io/todaylg/pen/OJJoYxa'>Threejs-Sakura-Step3:Vertex Animation</a> by todaylg\n  (<a href='https://codepen.io/todaylg'>@todaylg</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<h2>Particle</h2>\n<p>粒子化哗啦一下数量就多了：</p>\n<iframe height=\"300\" style=\"width: 100%;\" scrolling=\"no\" title=\"Threejs-Sakura-Step4:Particle\" src=\"https://codepen.io/todaylg/embed/mddQmbW?height=300&theme-id=default&default-tab=js,result\" frameborder=\"no\" allowtransparency=\"true\" allowfullscreen=\"true\">\n  See the Pen <a href='https://codepen.io/todaylg/pen/mddQmbW'>Threejs-Sakura-Step4:Particle</a> by todaylg\n  (<a href='https://codepen.io/todaylg'>@todaylg</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<h2>Light/PostProcessing</h2>\n<p>再加个简单的方向光和辉光、暗角的后处理，窃个Megumi的素材图，哗啦一下美爆了好吧！Rua！！（此处例子用的codesandbox，速度会慢一些）</p>\n<iframe\n     src=\"https://codesandbox.io/embed/sakura-tm298?fontsize=14&hidenavigation=1&theme=dark\"\n     style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\"\n     title=\"Sakura\"\n     allow=\"geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb\"\n     sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n   ></iframe>","fields":{"slug":"/sakura/","prefix":"2019-11-11"},"frontmatter":{"title":"Sakura是怎样炼成的","author":"todaylg","category":"小结","cover":{"childImageSharp":{"resize":{"src":"/static/bg-12b346669b3543f0c2bc8acf131e551b-ada8c.jpg"}}}}},"authornote":{"id":"20cdfd79-00b3-57fb-a29f-bb96dcd133a8","html":"<p><strong>todaylg</strong> </p>"},"site":{"siteMetadata":{"facebook":{"appId":""}}}},"pageContext":{"slug":"/sakura/","prev":{"id":"28a4bcb3-c090-548d-a2d6-9385dc1391a0","fields":{"slug":"/math-base-1/","prefix":"2019-07-24","source":"posts"},"frontmatter":{"title":"《Mathematics for 3D Game Programming and Computer Graphics》读书笔记 (上)","category":"读书流水"}},"source":"posts"}}